{"version":3,"file":"ContextMenu.js","sources":["../../src/ui/ContextMenu/MenuItems.tsx","../../src/ui/ContextMenu/EmojiListItems.tsx","../../src/ui/ContextMenu/index.tsx"],"sourcesContent":["import React, { ReactElement } from 'react';\nimport { createPortal } from 'react-dom';\n\ninterface MenuItemsProps {\n  className?: string;\n  style?: Record<string, string>;\n  openLeft?: boolean;\n  children: React.ReactElement | Array<React.ReactElement> | React.ReactNode;\n  parentRef: React.RefObject<HTMLElement>;\n  parentContainRef?: React.RefObject<HTMLElement>;\n  closeDropdown: () => void;\n}\n\ntype MenuStyleType = { top?: number, left?: number };\ninterface MenuItemsState {\n  menuStyle: MenuStyleType;\n  handleClickOutside: (e: MouseEvent) => void;\n}\n\n// padding to handle height of last item in message-list\nconst HEIGHT_PADDING = 60;\n\nexport default class MenuItems extends React.Component<MenuItemsProps, MenuItemsState> {\n  constructor(props: MenuItemsProps) {\n    super(props);\n    this.state = {\n      menuStyle: {},\n      handleClickOutside: () => { /* noop */ },\n    };\n  }\n\n  menuRef: React.RefObject<HTMLUListElement> = React.createRef();\n\n  componentDidMount(): void {\n    this.setupEvents();\n    this.getMenuPosition();\n  }\n\n  componentWillUnmount(): void {\n    this.cleanUpEvents();\n  }\n\n  setupEvents = (): void => {\n    const { closeDropdown } = this.props;\n    const { menuRef } = this;\n    const handleClickOutside = (event) => {\n      if (menuRef?.current && !menuRef?.current?.contains?.(event.target)) {\n        closeDropdown?.();\n      }\n    };\n    this.setState({\n      handleClickOutside,\n    });\n\n    document.addEventListener('mousedown', handleClickOutside);\n  };\n\n  cleanUpEvents = (): void => {\n    const {\n      handleClickOutside,\n    } = this.state;\n    document.removeEventListener('mousedown', handleClickOutside);\n  };\n\n  getMenuPosition = (): MenuStyleType => {\n    const { parentRef, openLeft } = this.props;\n    const parentRect = parentRef?.current?.getBoundingClientRect?.();\n    const x = parentRect?.x || parentRect?.left || 0;\n    const y = parentRect?.y || parentRect?.top || 0;\n    const menuStyle = {\n      top: y,\n      left: x,\n    };\n    if (!this.menuRef.current) return menuStyle;\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menuRef.current.getBoundingClientRect();\n    if (y + rect.height + HEIGHT_PADDING > innerHeight) {\n      menuStyle.top -= rect.height;\n    }\n    if (x + rect.width > innerWidth && !openLeft) {\n      menuStyle.left -= rect.width;\n    }\n    if (menuStyle.top < 0) {\n      menuStyle.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n    menuStyle.top += 32;\n    if (openLeft) {\n      const padding = Number.isNaN(rect.width - 30)\n        ? 108 // default\n        : rect.width - 30;\n      menuStyle.left -= padding;\n    }\n    // warning: this section has to be executed after the openLeft is calculated\n    // menu is outside viewport\n    if (menuStyle.left < 0) {\n      menuStyle.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    this.setState({ menuStyle });\n    return menuStyle;\n  };\n\n  render(): ReactElement {\n    const { menuStyle } = this.state;\n    const { children, style, className = '' } = this.props;\n    return (\n      createPortal(\n        (\n          <div className={this.props?.className}>\n            <div className=\"sendbird-dropdown__menu-backdrop\" />\n            <ul\n              className={`${className} sendbird-dropdown__menu`}\n              ref={this.menuRef}\n              style={{\n                display: 'inline-block',\n                position: 'fixed',\n                left: `${Math.round(menuStyle.left)}px`,\n                top: `${Math.round(menuStyle.top)}px`,\n                ...style,\n              }}\n            >\n              {children}\n            </ul>\n          </div>\n        ),\n        document.getElementById('sendbird-dropdown-portal'),\n      )\n    );\n  }\n}\n","import React, { ReactElement, ReactNode, RefObject, useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport SortByRow from '../SortByRow';\nimport { Nullable } from '../../types';\n\nconst defaultParentRect = { x: 0, y: 0, left: 0, top: 0, height: 0 };\ntype SpaceFromTrigger = { x: number, y: number };\ntype ReactionStyle = { left: number, top: number };\nexport interface EmojiListItemsProps {\n  closeDropdown: () => void;\n  children: ReactNode;\n  parentRef: RefObject<HTMLDivElement>;\n  parentContainRef: RefObject<HTMLDivElement>;\n  spaceFromTrigger?: SpaceFromTrigger;\n}\n\nexport const EmojiListItems = ({\n  children,\n  parentRef,\n  parentContainRef,\n  spaceFromTrigger = { x: 0, y: 0 },\n  closeDropdown,\n}: EmojiListItemsProps): Nullable<ReactElement> => {\n  const [reactionStyle, setReactionStyle] = useState<ReactionStyle>({ left: 0, top: 0 });\n  const reactionRef: RefObject<HTMLUListElement> = useRef(null);\n\n  /* showParent & hideParent */\n  useEffect(() => {\n    if (parentContainRef && parentContainRef?.current) {\n      parentContainRef.current.classList.add('sendbird-reactions--pressed');\n    }\n    return () => {\n      if (parentContainRef && parentContainRef?.current) {\n        parentContainRef.current.classList.remove('sendbird-reactions--pressed');\n      }\n    };\n  }, []);\n\n  /* setupEvents & cleanupEvents */\n  useEffect(() => {\n    const handleClickOutSide = (event) => {\n      if (reactionRef?.current && !reactionRef?.current?.contains?.(event.target)) {\n        closeDropdown();\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutSide);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutSide);\n    };\n  }, []);\n\n  /* getBarPosition */\n  useEffect(() => {\n    const spaceFromTriggerX = spaceFromTrigger?.x || 0;\n    const spaceFromTriggerY = spaceFromTrigger?.y || 0;\n    const parentRect = parentRef?.current?.getBoundingClientRect() ?? defaultParentRect;\n    const x = parentRect.x || parentRect.left;\n    const y = parentRect.y || parentRect.top;\n    const reactionStyle = {\n      top: y,\n      left: x,\n    };\n    if (!reactionRef?.current) {\n      setReactionStyle(reactionStyle);\n    } else {\n      const rect = reactionRef?.current?.getBoundingClientRect();\n      if (reactionStyle.top < rect.height) {\n        reactionStyle.top += parentRect.height;\n        reactionStyle.top += spaceFromTriggerY;\n      } else {\n        reactionStyle.top -= rect.height;\n        reactionStyle.top -= spaceFromTriggerY;\n      }\n      reactionStyle.left -= rect.width / 2;\n      reactionStyle.left += (parentRect.height / 2) - 2;\n      reactionStyle.left += spaceFromTriggerX;\n      const maximumLeft = window.innerWidth - rect.width;\n      if (maximumLeft < reactionStyle.left) {\n        reactionStyle.left = maximumLeft;\n      }\n      if (reactionStyle.left < 0) {\n        reactionStyle.left = 0;\n      }\n      setReactionStyle(reactionStyle);\n    }\n  }, []);\n\n  const rootElement = document.getElementById('sendbird-emoji-list-portal');\n  if (rootElement) {\n    return (\n      createPortal(\n        <>\n          <div className=\"sendbird-dropdown__menu-backdrop\" />\n          <ul\n            className=\"sendbird-dropdown__reaction-bar\"\n            ref={reactionRef}\n            style={{\n              display: 'inline-block',\n              position: 'fixed',\n              left: `${Math.round(reactionStyle.left)}px`,\n              top: `${Math.round(reactionStyle.top)}px`,\n            }}\n          >\n            <SortByRow\n              className=\"sendbird-dropdown__reaction-bar__row\"\n              maxItemCount={8}\n              itemWidth={44}\n              itemHeight={40}\n            >\n              {children}\n            </SortByRow>\n          </ul>\n        </>,\n        rootElement,\n      )\n    );\n  }\n  return null;\n};\n\nexport default EmojiListItems;\n","import React, { ReactElement, MouseEvent, useState, ReactNode } from 'react';\nimport './index.scss';\n\nimport _MenuItems from './MenuItems';\nimport _EmojiListItems from './EmojiListItems';\n\nimport { getClassName } from '../../utils';\nimport Label, { LabelTypography, LabelColors } from '../Label';\n\nconst ENTER_KEY = 13;\n\nexport const MenuItems = _MenuItems;\nexport const EmojiListItems = _EmojiListItems;\n\nexport interface MenuItemProps {\n  className?: string | Array<string>;\n  children: ReactElement | ReactElement[] | ReactNode;\n  onClick?: (e: MouseEvent<HTMLLIElement>) => void;\n  disable?: boolean;\n  dataSbId?: string;\n}\nexport const MenuItem = ({\n  className = '',\n  children,\n  onClick,\n  disable = false,\n  dataSbId = '',\n}: MenuItemProps): ReactElement => {\n  const handleClickEvent = (e) => {\n    if (!disable && onClick) {\n      onClick?.(e);\n    }\n  };\n  return (\n    <li\n      className={getClassName([className, 'sendbird-dropdown__menu-item', disable ? 'disable' : ''])}\n      role=\"menuitem\"\n      aria-disabled={disable ? true : false}\n      onClick={handleClickEvent}\n      onKeyPress={(e) => { if (e.keyCode === ENTER_KEY) handleClickEvent(e); }}\n      tabIndex={0}\n      data-sb-id={dataSbId}\n    >\n      <Label\n        className=\"sendbird-dropdown__menu-item__text\"\n        type={LabelTypography.SUBTITLE_2}\n        color={disable ? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_1}\n      >\n        {children}\n      </Label>\n    </li>\n  );\n};\n\nexport const MenuRoot = (): ReactElement => (\n  <div\n    id=\"sendbird-dropdown-portal\"\n    className=\"sendbird-dropdown-portal\"\n  />\n);\n\n// For the test environment\nexport const EmojiReactionListRoot = (): ReactElement => <div id=\"sendbird-emoji-list-portal\" />;\n\ntype MenuDisplayingFunc = () => void;\nexport interface ContextMenuProps {\n  menuTrigger?: (func: MenuDisplayingFunc) => ReactElement;\n  menuItems: (func: MenuDisplayingFunc) => ReactElement;\n  isOpen?: boolean;\n  onClick?: (...args: any[]) => void;\n}\nexport default function ContextMenu({\n  menuTrigger,\n  menuItems,\n  isOpen,\n  onClick,\n}: ContextMenuProps): ReactElement {\n  const [showMenu, setShowMenu] = useState(false);\n  return (\n    <div\n      className=\"sendbird-context-menu\"\n      style={{ display: 'inline' }}\n      onClick={onClick}\n    >\n      {menuTrigger?.(() => setShowMenu(!showMenu))}\n      {(showMenu || isOpen) && menuItems(() => setShowMenu(false))}\n    </div>\n  );\n}\n"],"names":["HEIGHT_PADDING","MenuItems","_super","__extends","props","_this","call","menuRef","React","createRef","setupEvents","closeDropdown","handleClickOutside","event","current","_b","_a","contains","target","setState","document","addEventListener","cleanUpEvents","state","removeEventListener","getMenuPosition","_c","parentRef","openLeft","parentRect","getBoundingClientRect","x","left","y","top","menuStyle","innerWidth","window","innerHeight","rect","height","width","padding","Number","isNaN","prototype","componentDidMount","componentWillUnmount","render","children","style","className","createPortal","createElement","concat","ref","__assign","display","position","Math","round","getElementById","Component","defaultParentRect","EmojiListItems","parentContainRef","spaceFromTrigger","useState","reactionStyle","setReactionStyle","reactionRef","useRef","useEffect","classList","add","remove","handleClickOutSide","spaceFromTriggerX","spaceFromTriggerY","maximumLeft","rootElement","Fragment","SortByRow","maxItemCount","itemWidth","itemHeight","ENTER_KEY","_MenuItems","_EmojiListItems","MenuItem","onClick","disable","_d","dataSbId","handleClickEvent","e","getClassName","role","onKeyPress","keyCode","tabIndex","Label","type","LabelTypography","SUBTITLE_2","color","LabelColors","ONBACKGROUND_4","ONBACKGROUND_1","MenuRoot","id","EmojiReactionListRoot","ContextMenu","menuTrigger","menuItems","isOpen","showMenu","setShowMenu"],"mappings":"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"}