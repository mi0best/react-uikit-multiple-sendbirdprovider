{"version":3,"file":"VoiceMessageItemBody.js","sources":["../../src/ui/VoiceMessageItemBody/index.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { FileMessage } from '@sendbird/chat/message';\n\nimport './index.scss';\n\nimport ProgressBar, { ProgressBarColorTypes } from '../ProgressBar';\nimport { useVoicePlayer } from '../../hooks/VoicePlayer/useVoicePlayer';\nimport PlaybackTime from '../PlaybackTime';\nimport Loader from '../Loader';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport { LabelTypography, LabelColors } from '../Label';\nimport { VOICE_PLAYER_STATUS } from '../../hooks/VoicePlayer/dux/initialState';\n\nexport interface VoiceMessageItemBodyProps {\n  className?: string;\n  message: FileMessage;\n  channelUrl: string;\n  isByMe?: boolean;\n  isReactionEnabled?: boolean;\n}\n\nexport const VoiceMessageItemBody = ({\n  className,\n  message,\n  channelUrl,\n  isByMe = false,\n  isReactionEnabled = false,\n}: VoiceMessageItemBodyProps): React.ReactElement => {\n  const [usingReaction, setUsingReaction] = useState(false);\n  const {\n    play,\n    // do not pause on unmount, because on desktop layout\n    // the component can be paused when it is played from\n    // channel and same message is unmounted from the thread\n    pause,\n    playbackTime = 0,\n    duration,\n    playingStatus = VOICE_PLAYER_STATUS.IDLE,\n  } = useVoicePlayer({\n    channelUrl,\n    key: `${message?.messageId}`,\n    audioFileUrl: message?.url,\n  });\n\n  useEffect(() => {\n    if (isReactionEnabled && message?.reactions?.length > 0) {\n      setUsingReaction(true);\n    } else {\n      setUsingReaction(false);\n    }\n  }, [isReactionEnabled, message?.reactions?.length]);\n  const progresBarMaxSize = useMemo(() => {\n    if (message?.metaArrays) {\n      const duration = message?.metaArrays.find((metaArray) => metaArray.key === 'KEY_VOICE_MESSAGE_DURATION')?.value[0];\n      return duration && parseInt(duration);\n    }\n    return 1;\n  }, [message?.metaArrays]);\n\n  return (\n    <div className={`sendbird-voice-message-item-body ${className} ${usingReaction ? 'is-reactions-contained' : ''}`}>\n      <ProgressBar\n        className=\"sendbird-voice-message-item-body__progress-bar\"\n        maxSize={duration || progresBarMaxSize}\n        currentSize={playbackTime}\n        colorType={isByMe ? ProgressBarColorTypes.PRIMARY : ProgressBarColorTypes.GRAY}\n      />\n      <div className=\"sendbird-voice-message-item-body__status-button\">\n        {(playingStatus === VOICE_PLAYER_STATUS.IDLE || playingStatus === VOICE_PLAYER_STATUS.PAUSED) && (\n          <div\n            className=\"sendbird-voice-message-item-body__status-button__button\"\n            onClick={play}\n          >\n            <Icon\n              width=\"18px\"\n              height=\"18px\"\n              type={IconTypes.PLAY}\n              fillColor={IconColors.PRIMARY}\n            />\n          </div>\n        )}\n        {playingStatus === VOICE_PLAYER_STATUS.PREPARING && (\n          <Loader width=\"22.2px\" height=\"22.2px\">\n            <Icon\n              width=\"22.2px\"\n              height=\"22.2px\"\n              type={IconTypes.SPINNER}\n              fillColor={IconColors.PRIMARY_2}\n            />\n          </Loader>\n        )}\n        {playingStatus === VOICE_PLAYER_STATUS.PLAYING && (\n          <div\n            className=\"sendbird-voice-message-item-body__status-button__button\"\n            onClick={() => { pause(); }}\n          >\n            <div className=\"sendbird-voice-message-item-body__status-button__button__pause\">\n              <div className=\"sendbird-voice-message-item-body__status-button__button__pause__inner\" />\n              <div className=\"sendbird-voice-message-item-body__status-button__button__pause__inner\" />\n            </div>\n          </div>\n        )}\n      </div>\n      <PlaybackTime\n        className=\"sendbird-voice-message-item-body__playback-time\"\n        time={progresBarMaxSize - playbackTime}\n        labelType={LabelTypography.BODY_1}\n        labelColor={isByMe ? LabelColors.ONCONTENT_1 : LabelColors.ONBACKGROUND_1}\n      />\n    </div>\n  );\n};\n\nexport default VoiceMessageItemBody;\n"],"names":["VoiceMessageItemBody","_a","className","message","channelUrl","_c","isByMe","_d","isReactionEnabled","_e","useState","usingReaction","setUsingReaction","_f","useVoicePlayer","key","messageId","audioFileUrl","url","play","pause","_g","playbackTime","duration","_h","playingStatus","VOICE_PLAYER_STATUS","IDLE","useEffect","reactions","length","_b","progresBarMaxSize","useMemo","metaArrays","duration_1","find","metaArray","value","parseInt","React","createElement","concat","ProgressBar","maxSize","currentSize","colorType","ProgressBarColorTypes","PRIMARY","GRAY","PAUSED","onClick","Icon","width","height","type","IconTypes","PLAY","fillColor","IconColors","PREPARING","Loader","SPINNER","PRIMARY_2","PLAYING","PlaybackTime","time","labelType","LabelTypography","BODY_1","labelColor","LabelColors","ONCONTENT_1","ONBACKGROUND_1"],"mappings":"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"}