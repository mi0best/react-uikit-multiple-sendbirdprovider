'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var _rollupPluginBabelHelpers = require('../_rollupPluginBabelHelpers-f5b0dfb9.js');
var tslib_es6 = require('../tslib.es6-c74b513f.js');
var React = require('react');
var index$1 = require('../index-54279ec2.js');
var utils = require('../utils-eb6d90e0.js');
var ui_Modal = require('../ui/Modal.js');
var index = require('../index-b8ba4548.js');
require('react-dom');
require('../LocalizationContext-58b6ed7c.js');
require('../stringSet-1539ac47.js');
require('../index-e8928da6.js');
require('../MediaQueryContext-6141d955.js');
require('../ui/IconButton.js');
require('../ui/Button.js');
require('../index-b5a9b4b7.js');
require('prop-types');
require('../types-d0d770c3.js');
require('../ui/Icon.js');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);

var GlobalModalContext = /*#__PURE__*/React.createContext({
  openModal: utils.noop
});
var GlobalModalProvider = function (_a) {
  var children = _a.children;
  // Idea from https://dev.to/nurislamov/simple-modals-queue-in-react-4g6c
  var _b = React.useState([]),
    globalModalQueue = _b[0],
    setGlobalModalQueue = _b[1];
  var openModal = React.useCallback(function (props) {
    setGlobalModalQueue(function (currentQue) {
      return tslib_es6.__spreadArray(tslib_es6.__spreadArray([], currentQue, true), [props], false);
    });
  }, []);
  var closeModal = React.useCallback(function () {
    setGlobalModalQueue(function (currentQue) {
      return currentQue.slice(1);
    });
  }, []);
  var ModalComponent = React.useMemo(function () {
    return function () {
      return index$1.K(globalModalQueue).when(function (q) {
        return q.length === 0;
      }, function () {
        return /*#__PURE__*/React__default["default"].createElement(React__default["default"].Fragment, null);
      }).otherwise(function () {
        var _a = globalModalQueue[0],
          modalProps = _a.modalProps,
          childElement = _a.childElement;
        return /*#__PURE__*/React__default["default"].createElement(ui_Modal.Modal, _rollupPluginBabelHelpers._extends({}, modalProps, {
          className: "sendbird-global-modal ".concat(modalProps === null || modalProps === void 0 ? void 0 : modalProps.className),
          onClose: function () {
            var _a;
            (_a = modalProps === null || modalProps === void 0 ? void 0 : modalProps.onClose) === null || _a === void 0 ? void 0 : _a.call(modalProps);
            closeModal();
          }
        }), childElement({
          closeModal: closeModal
        }));
      });
    };
  }, [globalModalQueue]);
  return /*#__PURE__*/React__default["default"].createElement(GlobalModalContext.Provider, {
    value: {
      openModal: openModal
    }
  }, /*#__PURE__*/React__default["default"].createElement(ModalComponent, null), children);
};
var useGlobalModalContext = function () {
  return React.useContext(GlobalModalContext);
};

exports.MODAL_ROOT = index.MODAL_ROOT;
exports.ModalRoot = index.ModalRoot;
exports.GlobalModalProvider = GlobalModalProvider;
exports.useGlobalModalContext = useGlobalModalContext;
//# sourceMappingURL=useModal.js.map
