{"version":3,"file":"useModal.js","sources":["../../../src/hooks/useModal/index.tsx"],"sourcesContent":["import React, { useState, useCallback, ReactElement, createContext, useMemo, useContext } from 'react';\nimport { match } from 'ts-pattern';\n\nimport { noop } from '../../utils/utils';\nimport Modal, { type ModalProps } from '../../ui/Modal';\n\nexport type OpenGlobalModalProps = {\n  modalProps: ModalProps;\n  childElement: (props: { closeModal: () => void }) => ReactElement;\n};\nexport type GlobalModalProviderProps = React.PropsWithChildren;\nexport interface GlobalModalContextInterface {\n  openModal: (props: OpenGlobalModalProps) => void;\n}\n\nconst GlobalModalContext = createContext<GlobalModalContextInterface>({\n  openModal: noop,\n});\n\nexport const GlobalModalProvider = ({ children }: GlobalModalProviderProps) => {\n  // Idea from https://dev.to/nurislamov/simple-modals-queue-in-react-4g6c\n  const [globalModalQueue, setGlobalModalQueue] = useState<Array<OpenGlobalModalProps>>([]);\n\n  const openModal = useCallback((props: OpenGlobalModalProps) => {\n    setGlobalModalQueue((currentQue) => [...currentQue, props]);\n  }, []);\n\n  const closeModal = useCallback(() => {\n    setGlobalModalQueue((currentQue) => currentQue.slice(1));\n  }, []);\n\n  const ModalComponent = useMemo(() => () => {\n    return match(globalModalQueue)\n      .when(q => q.length === 0, () => {\n        return <></>;\n      })\n      .otherwise(() => {\n        const { modalProps, childElement } = globalModalQueue[0];\n        return (\n          <Modal\n            {...modalProps}\n            className={`sendbird-global-modal ${modalProps?.className}`}\n            onClose={() => {\n              modalProps?.onClose?.();\n              closeModal();\n            }}\n          >\n            {\n              childElement({\n                closeModal,\n              })\n            }\n          </Modal>\n        );\n      });\n  }, [globalModalQueue]);\n\n  return (\n    <GlobalModalContext.Provider\n      value={{\n        openModal,\n      }}\n    >\n      <ModalComponent />\n      {children}\n    </GlobalModalContext.Provider>\n  );\n};\nexport const useGlobalModalContext = (): GlobalModalContextInterface => useContext(GlobalModalContext);\n\nexport * from './ModalRoot';\n"],"names":["GlobalModalContext","createContext","openModal","noop","GlobalModalProvider","_a","children","_b","useState","globalModalQueue","setGlobalModalQueue","useCallback","props","currentQue","__spreadArray","closeModal","slice","ModalComponent","useMemo","match","when","q","length","React","createElement","Fragment","otherwise","modalProps","childElement","Modal","_extends","className","concat","onClose","Provider","value","useGlobalModalContext","useContext"],"mappings":"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"}