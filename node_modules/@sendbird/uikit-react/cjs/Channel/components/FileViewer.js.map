{"version":3,"file":"FileViewer.js","sources":["../../../../src/modules/Channel/components/FileViewer/index.tsx"],"sourcesContent":["import React from 'react';\nimport { createPortal } from 'react-dom';\nimport type { FileMessage } from '@sendbird/chat/message';\n\nimport './file-viewer.scss';\nimport Avatar from '../../../../ui/Avatar';\nimport Label, { LabelTypography, LabelColors } from '../../../../ui/Label';\nimport Icon, { IconColors, IconTypes } from '../../../../ui/Icon';\nimport { MODAL_ROOT } from '../../../../hooks/useModal';\n\nimport { isImage, isVideo, isSupportedFileView } from '../../../../utils';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\nimport { useChannelContext } from '../../context/ChannelProvider';\nimport { EveryMessage } from '../../../../types';\n\ntype FileViewerUIProps = {\n  profileUrl: string;\n  nickname: string;\n  // file\n  name: string;\n  type: string;\n  url: string;\n  // others\n  isByMe: boolean;\n  onCancel: () => void;\n  onDelete: () => void;\n  disableDelete: boolean;\n};\n\nexport const FileViewerComponent: React.FC<FileViewerUIProps> = ({\n  // sender\n  profileUrl,\n  nickname,\n  // file\n  name,\n  type,\n  url,\n  // others\n  isByMe,\n  onCancel,\n  onDelete,\n  disableDelete,\n}: FileViewerUIProps) => (\n  <div className=\"sendbird-fileviewer\">\n    <div className=\"sendbird-fileviewer__header\">\n      <div className=\"sendbird-fileviewer__header__left\">\n        <div className=\"sendbird-fileviewer__header__left__avatar\">\n          <Avatar height=\"32px\" width=\"32px\" src={profileUrl} />\n        </div>\n        <Label\n          className=\"sendbird-fileviewer__header__left__filename\"\n          type={LabelTypography.H_2}\n          color={LabelColors.ONBACKGROUND_1}\n        >\n          {name}\n        </Label>\n        <Label\n          className=\"sendbird-fileviewer__header__left__sender-name\"\n          type={LabelTypography.BODY_1}\n          color={LabelColors.ONBACKGROUND_2}\n        >\n          {nickname}\n        </Label>\n      </div>\n      <div className=\"sendbird-fileviewer__header__right\">\n        {\n          isSupportedFileView(type) && (\n            <div className=\"sendbird-fileviewer__header__right__actions\">\n              <a\n                className=\"sendbird-fileviewer__header__right__actions__download\"\n                rel=\"noopener noreferrer\"\n                href={url}\n                target=\"_blank\"\n              >\n                <Icon\n                  type={IconTypes.DOWNLOAD}\n                  fillColor={IconColors.ON_BACKGROUND_1}\n                  height=\"24px\"\n                  width=\"24px\"\n                />\n              </a>\n              {\n                onDelete && isByMe && (\n                  <div className=\"sendbird-fileviewer__header__right__actions__delete\">\n                    <Icon\n                      className={disableDelete ? 'disabled' : ''}\n                      type={IconTypes.DELETE}\n                      fillColor={disableDelete ? IconColors.GRAY : IconColors.ON_BACKGROUND_1}\n                      height=\"24px\"\n                      width=\"24px\"\n                      onClick={() => { if (!disableDelete) { onDelete(); } }}\n                    />\n                  </div>\n                )\n              }\n            </div>\n          )\n        }\n        <div className=\"sendbird-fileviewer__header__right__actions__close\">\n          <Icon\n            type={IconTypes.CLOSE}\n            fillColor={IconColors.ON_BACKGROUND_1}\n            height=\"24px\"\n            width=\"24px\"\n            onClick={onCancel}\n          />\n        </div>\n      </div>\n    </div>\n    <div className=\"sendbird-fileviewer__content\">\n      {isVideo(type) && (\n        <video controls className=\"sendbird-fileviewer__content__video\">\n          <source src={url} type={type} />\n        </video>\n      )}\n      {\n        isImage(type) && (\n          <img\n            src={url}\n            alt={name}\n            className=\"sendbird-fileviewer__content__img\"\n          />\n        )\n      }\n      {\n        !isSupportedFileView(type) && (\n          <div className=\"sendbird-fileviewer__content__unsupported\">\n            <Label type={LabelTypography.H_1} color={LabelColors.ONBACKGROUND_1}>\n              Unsupoprted message\n            </Label>\n          </div>\n        )\n      }\n    </div>\n  </div>\n);\n\ntype FileViewerProps = {\n  onCancel:() => void;\n  message: FileMessage;\n};\n\nconst FileViewer: React.FC<FileViewerProps> = ({ onCancel, message }: FileViewerProps) => {\n  const { deleteMessage } = useChannelContext();\n  const {\n    sender,\n    type,\n    url,\n    name = '',\n    threadInfo,\n  } = message;\n  const user = useSendbirdStateContext()?.config?.userId;\n  const isByMe = user === message?.sender?.userId;\n  const disableDelete = threadInfo?.replyCount > 0;\n  const { profileUrl, nickname = '' } = sender;\n  return createPortal(\n    (\n      <FileViewerComponent\n        profileUrl={profileUrl}\n        nickname={nickname}\n        type={type}\n        url={url}\n        name={name}\n        onCancel={onCancel}\n        onDelete={() => {\n          deleteMessage(message as EveryMessage).then(() => {\n            onCancel();\n          });\n        }}\n        isByMe={isByMe}\n        disableDelete={disableDelete}\n      />\n    ),\n    document.getElementById(MODAL_ROOT),\n  );\n};\n\nexport default FileViewer;\n"],"names":["FileViewerComponent","_a","profileUrl","nickname","name","type","url","isByMe","onCancel","onDelete","disableDelete","React","createElement","className","Avatar","height","width","src","Label","LabelTypography","H_2","color","LabelColors","ONBACKGROUND_1","BODY_1","ONBACKGROUND_2","isSupportedFileView","rel","href","target","Icon","IconTypes","DOWNLOAD","fillColor","IconColors","ON_BACKGROUND_1","DELETE","GRAY","onClick","CLOSE","isVideo","controls","isImage","alt","H_1","FileViewer","message","deleteMessage","useChannelContext","sender","_e","threadInfo","user","_c","_b","useSendbirdStateContext","config","userId","_d","replyCount","_f","createPortal","then","document","getElementById","MODAL_ROOT"],"mappings":"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"}