{"version":3,"file":"useHandleUploadFiles-39e8d107.js","sources":["../../src/modules/Channel/components/MessageInput/VoiceMessageInputWrapper.tsx","../../src/modules/Channel/components/MessageInput/useHandleUploadFiles.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { GroupChannel } from '@sendbird/chat/groupChannel';\nimport './voice-message-wrapper.scss';\n\nimport { useLocalization } from '../../../../lib/LocalizationContext';\nimport { useVoicePlayer } from '../../../../hooks/VoicePlayer/useVoicePlayer';\nimport { useVoiceRecorder, VoiceRecorderStatus } from '../../../../hooks/VoiceRecorder/useVoiceRecorder';\nimport { isDisabledBecauseFrozen, isDisabledBecauseMuted } from '../../context/utils';\n\nimport { VoiceMessageInput } from '../../../../ui/VoiceMessageInput';\nimport { VoiceMessageInputStatus } from '../../../../ui/VoiceMessageInput/types';\nimport Modal from '../../../../ui/Modal';\nimport Button, { ButtonSizes, ButtonTypes } from '../../../../ui/Button';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\nimport { VOICE_RECORDER_DEFAULT_MIN } from '../../../../utils/consts';\nimport { VOICE_PLAYER_STATUS } from '../../../../hooks/VoicePlayer/dux/initialState';\nimport uuidv4 from '../../../../utils/uuid';\n\nexport interface VoiceMessageInputWrapperProps {\n  channel?: GroupChannel;\n  onCancelClick?: () => void;\n  onSubmitClick?: (file: File, duration: number) => void;\n}\n\nexport const VoiceMessageInputWrapper = ({\n  channel,\n  onCancelClick,\n  onSubmitClick,\n}: VoiceMessageInputWrapperProps): React.ReactElement => {\n  const uuid = useRef<string>(uuidv4()).current;\n  const [audioFile, setAudioFile] = useState<File>(null);\n  const [voiceInputState, setVoiceInputState] = useState<VoiceMessageInputStatus>(VoiceMessageInputStatus.READY_TO_RECORD);\n  const [isSubmitted, setSubmit] = useState(false);\n  const [isDisabled, setDisabled] = useState(false);\n  const [showModal, setShowModal] = useState(false);\n  const { stringSet } = useLocalization();\n  const { config } = useSendbirdStateContext();\n  const minRecordingTime = config?.voiceRecord?.minRecordingTime || VOICE_RECORDER_DEFAULT_MIN;\n  const {\n    start,\n    stop,\n    cancel,\n    recordingTime,\n    recordingStatus,\n    recordingLimit,\n  } = useVoiceRecorder({\n    onRecordingStarted: () => {\n      setVoiceInputState(VoiceMessageInputStatus.RECORDING);\n    },\n    onRecordingEnded: (audioFile) => {\n      setAudioFile(audioFile);\n    },\n  });\n  const voicePlayer = useVoicePlayer({\n    channelUrl: channel?.url,\n    key: uuid,\n    audioFile: audioFile,\n  });\n  const {\n    play,\n    pause,\n    playbackTime,\n    playingStatus,\n  } = voicePlayer;\n  const stopVoicePlayer = voicePlayer.stop;\n\n  // disabled state: muted & frozen\n  useEffect(() => {\n    if (isDisabledBecauseFrozen(channel) || isDisabledBecauseMuted(channel)) {\n      setDisabled(true);\n    } else {\n      setDisabled(false);\n    }\n  }, [channel?.myRole, channel?.isFrozen, channel?.myMutedState]);\n\n  // call onSubmitClick when submit button is clicked and recorded audio file is created\n  useEffect(() => {\n    if (isSubmitted && audioFile) {\n      onSubmitClick(audioFile, recordingTime);\n      setSubmit(false);\n      setAudioFile(null);\n    }\n  }, [isSubmitted, audioFile, recordingTime]);\n  // operate which control button should be displayed\n  useEffect(() => {\n    if (audioFile) {\n      if (recordingTime < minRecordingTime) {\n        setVoiceInputState(VoiceMessageInputStatus.READY_TO_RECORD);\n        setAudioFile(null);\n      } else if (playingStatus === VOICE_PLAYER_STATUS.PLAYING) {\n        setVoiceInputState(VoiceMessageInputStatus.PLAYING);\n      } else {\n        setVoiceInputState(VoiceMessageInputStatus.READY_TO_PLAY);\n      }\n    }\n  }, [audioFile, recordingTime, playingStatus]);\n\n  return (\n    <div className=\"sendbird-voice-message-input-wrapper\">\n      <VoiceMessageInput\n        currentValue={recordingStatus === VoiceRecorderStatus.COMPLETED ? playbackTime : recordingTime}\n        maximumValue={recordingStatus === VoiceRecorderStatus.COMPLETED ? recordingTime : recordingLimit}\n        currentType={voiceInputState}\n        onCancelClick={() => {\n          onCancelClick();\n          cancel();\n          stopVoicePlayer();\n        }}\n        onSubmitClick={() => {\n          if (isDisabled) {\n            setShowModal(true);\n            setVoiceInputState(VoiceMessageInputStatus.READY_TO_RECORD);\n          } else {\n            stop();\n            pause();\n            setSubmit(true);\n          }\n        }}\n        onControlClick={(type) => {\n          switch (type) {\n            case VoiceMessageInputStatus.READY_TO_RECORD: {\n              stopVoicePlayer();\n              start();\n              break;\n            }\n            case VoiceMessageInputStatus.RECORDING: {\n              if (recordingTime >= minRecordingTime && !isDisabled) {\n                stop();\n              } else if (isDisabled) {\n                cancel();\n                setShowModal(true);\n                setVoiceInputState(VoiceMessageInputStatus.READY_TO_RECORD);\n              } else {\n                cancel();\n                setVoiceInputState(VoiceMessageInputStatus.READY_TO_RECORD);\n              }\n              break;\n            }\n            case VoiceMessageInputStatus.READY_TO_PLAY: {\n              play();\n              break;\n            }\n            case VoiceMessageInputStatus.PLAYING: {\n              pause();\n              break;\n            }\n          }\n        }}\n      />\n      {\n        showModal && (\n          <Modal\n            className=\"sendbird-voice-message-input-wrapper-alert\"\n            titleText={isDisabledBecauseMuted(channel)\n              ? stringSet.MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED\n              : stringSet.MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN\n            }\n            hideFooter\n            isCloseOnClickOutside\n            onCancel={() => {\n              setShowModal(false);\n              onCancelClick();\n            }}\n          >\n            <div className=\"sendbird-voice-message-input-wrapper-alert__body\">\n              <Button\n                className=\"sendbird-voice-message-input-wrapper-alert__body__ok-button\"\n                type={ButtonTypes.PRIMARY}\n                size={ButtonSizes.BIG}\n                onClick={() => {\n                  setShowModal(false);\n                  onCancelClick();\n                }}\n              >\n                {stringSet.BUTTON__OK}\n              </Button>\n            </div>\n          </Modal>\n        )\n      }\n    </div>\n  );\n};\n\nexport default VoiceMessageInputWrapper;\n","import React, { useCallback } from 'react';\n\nimport { Logger } from '../../../../lib/SendbirdState';\nimport { SendMFMFunctionType } from '../../context/hooks/useSendMultipleFilesMessage';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\nimport { SendableMessageType, isImage } from '../../../../utils';\n// TODO: get SendFileMessageFunctionType from Channel\nimport { SendFileMessageFunctionType } from '../../../Thread/context/hooks/useSendFileMessage';\nimport { useGlobalModalContext } from '../../../../hooks/useModal';\nimport { ButtonTypes } from '../../../../ui/Button';\nimport { useLocalization } from '../../../../lib/LocalizationContext';\nimport { ModalFooter } from '../../../../ui/Modal';\nimport { FileMessage, MultipleFilesMessage } from '@sendbird/chat/message';\n\n/**\n * The handleUploadFiles is a function sending a FileMessage and MultipleFilesMessage\n * by the received FileList from the ChangeEvent of MessageInput component.\n */\n\ninterface useHandleUploadFilesDynamicProps {\n  sendFileMessage: SendFileMessageFunctionType;\n  sendMultipleFilesMessage: SendMFMFunctionType;\n  quoteMessage?: SendableMessageType;\n}\ninterface useHandleUploadFilesStaticProps {\n  logger: Logger;\n}\nexport type HandleUploadFunctionType = (files: FileList) => void;\n\nexport const useHandleUploadFiles = ({\n  sendFileMessage,\n  sendMultipleFilesMessage,\n  quoteMessage,\n}: useHandleUploadFilesDynamicProps, {\n  logger,\n}: useHandleUploadFilesStaticProps): Array<HandleUploadFunctionType> => {\n  const { stringSet } = useLocalization();\n  const { config } = useSendbirdStateContext();\n  const uikitUploadSizeLimit = config?.uikitUploadSizeLimit;\n  const uikitMultipleFilesMessageLimit = config?.uikitMultipleFilesMessageLimit;\n  const { openModal } = useGlobalModalContext();\n\n  const handleUploadFiles = useCallback((fileList: FileList) => {\n    const files: File[] = Array.from(fileList);\n\n    // Validate Paremeters\n    if (!sendFileMessage || !sendMultipleFilesMessage) {\n      logger.warning('Channel|useHandleUploadFiles: required functions are undefined', { sendFileMessage, sendMultipleFilesMessage });\n      return;\n    }\n    if (files.length === 0) {\n      logger.warning('Channel|useHandleUploadFiles: given file list is empty.', { files });\n      return;\n    }\n    if (files.length > uikitMultipleFilesMessageLimit) {\n      logger.info(`Channel|useHandleUploadFiles: Cannot upload files more than ${uikitMultipleFilesMessageLimit}`);\n      openModal({\n        modalProps: {\n          titleText: `Up to ${uikitMultipleFilesMessageLimit} files can be attached.`,\n          hideFooter: true,\n        },\n        childElement: ({ closeModal }) => (\n          <ModalFooter\n            type={ButtonTypes.PRIMARY}\n            submitText={stringSet.BUTTON__OK}\n            hideCancelButton\n            onCancel={closeModal}\n            onSubmit={closeModal}\n          />\n        ),\n      });\n      return;\n    }\n    if (files.some((file: File) => file.size > uikitUploadSizeLimit)) {\n      // The default value of uikitUploadSizeLimit is 26MB\n      logger.info(`Channel|useHandleUploadFiles: Cannot upload file size exceeding ${uikitUploadSizeLimit}`);\n      const ONE_MiB = 1024 * 1024;\n      openModal({\n        modalProps: {\n          titleText: `The maximum size per file is ${Math.floor(uikitUploadSizeLimit / ONE_MiB)} MB.`,\n          hideFooter: true,\n        },\n        childElement: ({ closeModal }) => (\n          <ModalFooter\n            type={ButtonTypes.PRIMARY}\n            submitText={stringSet.BUTTON__OK}\n            hideCancelButton\n            onCancel={closeModal}\n            onSubmit={closeModal}\n          />\n        ),\n      });\n      return;\n    }\n\n    if (files.length === 1) {\n      logger.info('Channel|useHandleUploadFiles: sending one file.');\n      const [file] = files;\n      sendFileMessage(file, quoteMessage);\n    } else if (files.length > 1) {\n      logger.info('Channel|useHandleUploadFiles: sending multiple files.');\n      const imageFiles: Array<File> = [];\n      const otherFiles: Array<File> = [];\n      files.forEach((file: File) => {\n        if (isImage(file.type)) {\n          imageFiles.push(file);\n        } else {\n          otherFiles.push(file);\n        }\n      });\n\n      return otherFiles.reduce((\n        previousPromise: Promise<MultipleFilesMessage | FileMessage | void>,\n        item: File,\n      ) => {\n        return previousPromise.then(() => {\n          return sendFileMessage(item as File, quoteMessage);\n        });\n      }, (() => {\n        if (imageFiles.length === 0) {\n          return Promise.resolve();\n        } else if (imageFiles.length === 1) {\n          return sendFileMessage(imageFiles[0], quoteMessage);\n        } else {\n          return sendMultipleFilesMessage(imageFiles, quoteMessage);\n        }\n      })());\n    }\n  }, [\n    sendFileMessage,\n    sendMultipleFilesMessage,\n    quoteMessage,\n  ]);\n\n  return [handleUploadFiles];\n};\n"],"names":["VoiceMessageInputWrapper","_a","channel","onCancelClick","onSubmitClick","uuid","useRef","uuidv4","current","_c","useState","audioFile","setAudioFile","_d","VoiceMessageInputStatus","READY_TO_RECORD","voiceInputState","setVoiceInputState","_e","isSubmitted","setSubmit","_f","isDisabled","setDisabled","_g","showModal","setShowModal","stringSet","useLocalization","config","useSendbirdStateContext","minRecordingTime","_b","voiceRecord","VOICE_RECORDER_DEFAULT_MIN","_h","useVoiceRecorder","onRecordingStarted","RECORDING","onRecordingEnded","start","stop","cancel","recordingTime","recordingStatus","recordingLimit","voicePlayer","useVoicePlayer","channelUrl","url","key","play","pause","playbackTime","playingStatus","stopVoicePlayer","useEffect","isDisabledBecauseFrozen","isDisabledBecauseMuted","myRole","isFrozen","myMutedState","VOICE_PLAYER_STATUS","PLAYING","READY_TO_PLAY","React","createElement","className","VoiceMessageInput","currentValue","VoiceRecorderStatus","COMPLETED","maximumValue","currentType","onControlClick","type","Modal","titleText","MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED","MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN","hideFooter","isCloseOnClickOutside","onCancel","Button","ButtonTypes","PRIMARY","size","ButtonSizes","BIG","onClick","BUTTON__OK","useHandleUploadFiles","sendFileMessage","sendMultipleFilesMessage","quoteMessage","logger","uikitUploadSizeLimit","uikitMultipleFilesMessageLimit","openModal","useGlobalModalContext","handleUploadFiles","useCallback","fileList","files","Array","from","warning","length","info","modalProps","concat","childElement","closeModal","ModalFooter","submitText","hideCancelButton","onSubmit","some","file","ONE_MiB","Math","floor","imageFiles_1","otherFiles_1","forEach","isImage","push","reduce","previousPromise","item","then","Promise","resolve"],"mappings":"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"}