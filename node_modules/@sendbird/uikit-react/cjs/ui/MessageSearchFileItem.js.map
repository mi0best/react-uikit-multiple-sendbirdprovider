{"version":3,"file":"MessageSearchFileItem.js","sources":["../../../src/ui/MessageSearchFileItem/utils.ts","../../../src/ui/MessageSearchFileItem/index.tsx"],"sourcesContent":["import type { FileMessage } from '@sendbird/chat/message';\nimport type { Locale } from 'date-fns';\nimport format from 'date-fns/format';\nimport isToday from 'date-fns/isToday';\nimport isThisYear from 'date-fns/isThisYear';\nimport isYesterday from 'date-fns/isYesterday';\nimport { IconTypes } from '../Icon';\nimport { isVoiceMessage } from '../../utils';\nimport { getMessageFirstFileUrl } from '../QuoteMessage/utils';\nimport { MultipleFilesMessage } from '@sendbird/chat/message';\n\nexport interface GetCreatedAtProps {\n  createdAt: number;\n  locale?: Locale;\n  stringSet?: Record<string, string>;\n}\n\nexport function getCreatedAt({ createdAt, locale, stringSet }: GetCreatedAtProps): string {\n  const optionalParam = locale ? { locale } : null;\n  if (!createdAt) {\n    return '';\n  }\n  if (isToday(createdAt)) {\n    return format(createdAt, 'p', optionalParam);\n  }\n  if (isYesterday(createdAt)) {\n    return stringSet?.MESSAGE_STATUS__YESTERDAY || 'Yesterday';\n  }\n  if (isThisYear(createdAt)) {\n    return format(createdAt, 'MMM d', optionalParam);\n  }\n  return format(createdAt, 'yyyy/M/d', optionalParam);\n}\n\nexport function getIconOfFileType(message: FileMessage | MultipleFilesMessage): string {\n  const fileMessageUrl = getMessageFirstFileUrl(message) ?? '';\n  const fileExtension = (fileMessageUrl.match(/\\.([^.]*?)(?=\\?|#|$)/))?.[1] ?? '';\n\n  if (/(jpg|jpeg|png)$/i.test(fileExtension)) {\n    return IconTypes.PHOTO;\n  } else if (/mp4$/i.test(fileExtension) || isVoiceMessage(message)) {\n    return IconTypes.PLAY;\n  } else if (/mp3/i.test(fileExtension)) {\n    return IconTypes.FILE_AUDIO;\n  } else if (/gif/i.test(fileExtension)) {\n    return IconTypes.GIF;\n  } else {\n    return IconTypes.FILE_DOCUMENT;\n  }\n}\n\nexport function truncate(fullText: string, textLimit: number): string {\n  if (fullText.length <= textLimit) return fullText;\n  const separator = '...';\n  const sepLen = separator.length;\n  const charsToShow = textLimit - sepLen;\n  const frontChars = Math.ceil(charsToShow / 2);\n  const backChars = Math.floor(charsToShow / 2);\n  return fullText.substr(0, frontChars) + separator + fullText.substr(fullText.length - backChars);\n}\n","import './index.scss';\nimport React, { ReactElement } from 'react';\nimport type { FileMessage } from '@sendbird/chat/message';\n\nimport Avatar from '../Avatar';\nimport Icon, { IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { useLocalization } from '../../lib/LocalizationContext';\nimport { getCreatedAt, getIconOfFileType } from './utils';\nimport { isVoiceMessage } from '../../utils';\nimport { MultipleFilesMessage } from '@sendbird/chat/message';\nimport { getMessageFirstFileName, getMessageFirstFileUrl } from '../QuoteMessage/utils';\n\ninterface Props {\n  className?: string | Array<string>;\n  message: FileMessage | MultipleFilesMessage;\n  selected?: boolean;\n  onClick?: (message: FileMessage | MultipleFilesMessage) => void;\n}\n\nexport default function MessageSearchFileItem(props: Props): ReactElement {\n  const {\n    className,\n    message,\n    selected,\n    onClick,\n  } = props;\n  const { createdAt } = message;\n  const url: string = getMessageFirstFileUrl(message);\n  const name: string = getMessageFirstFileName(message);\n  // @ts-ignore\n  const sender = message.sender || message._sender;\n  const { profileUrl, nickname } = sender;\n  const { stringSet, dateLocale } = useLocalization();\n  const isVoiceMsg = isVoiceMessage(message);\n  const prettyFilename = isVoiceMsg ? stringSet.VOICE_MESSAGE : (name || url);\n\n  return (\n    <div\n      className={[\n        ...(Array.isArray(className) ? className : [className]),\n        'sendbird-message-search-file-item',\n        selected ? 'sendbird-message-search-file-item--selected' : '',\n      ].join(' ')}\n      onClick={(e) => {\n        e.stopPropagation();\n        onClick(message);\n      }}\n    >\n      <div className=\"sendbird-message-search-file-item__left\">\n        <Avatar\n          className=\"sendbird-message-search-file-item__left__sender-avatar\"\n          src={profileUrl}\n          alt=\"profile image\"\n          width=\"56px\"\n          height=\"56px\"\n        />\n      </div>\n      <div className=\"sendbird-message-search-file-item__right\">\n        <Label\n          className=\"sendbird-message-search-file-item__right__sender-name\"\n          type={LabelTypography.SUBTITLE_2}\n          color={LabelColors.ONBACKGROUND_1}\n        >\n          {nickname || stringSet.NO_NAME}\n        </Label>\n        <div className=\"sendbird-message-search-file-item__right__content\">\n          {!isVoiceMsg && (\n            <div className={'sendbird-message-search-file-item__right__content__type-icon'}>\n              <Icon\n                type={getIconOfFileType(message)}\n                fillColor={IconColors.PRIMARY}\n                width=\"18px\"\n                height=\"18px\"\n              />\n            </div>\n          )}\n          <Label\n            className=\"sendbird-message-search-file-item__right__content__url\"\n            type={LabelTypography.BODY_2}\n            color={LabelColors.ONBACKGROUND_1}\n          >\n            {prettyFilename}\n          </Label>\n        </div>\n      </div>\n      <Label\n        className=\"sendbird-message-search-file-item__message-created-at\"\n        type={LabelTypography.CAPTION_3}\n        color={LabelColors.ONBACKGROUND_2}\n      >\n        {getCreatedAt({ createdAt, locale: dateLocale, stringSet })}\n      </Label>\n      <div className=\"sendbird-message-search-file-item__right-footer\" />\n    </div>\n  );\n}\n"],"names":["getCreatedAt","_a","createdAt","locale","stringSet","optionalParam","isToday","format","isYesterday","MESSAGE_STATUS__YESTERDAY","isThisYear","getIconOfFileType","message","fileMessageUrl","getMessageFirstFileUrl","fileExtension","_c","_b","match","test","IconTypes","PHOTO","isVoiceMessage","PLAY","FILE_AUDIO","GIF","FILE_DOCUMENT","MessageSearchFileItem","props","className","selected","onClick","url","name","getMessageFirstFileName","sender","_sender","profileUrl","nickname","useLocalization","dateLocale","isVoiceMsg","prettyFilename","VOICE_MESSAGE","React","createElement","__spreadArray","Array","isArray","join","e","stopPropagation","Avatar","src","alt","width","height","Label","type","LabelTypography","SUBTITLE_2","color","LabelColors","ONBACKGROUND_1","NO_NAME","Icon","fillColor","IconColors","PRIMARY","BODY_2","CAPTION_3","ONBACKGROUND_2"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAiBM,SAAUA,YAAYA,CAACC,EAAmD,EAAA;AAAjD,EAAA,IAAAC,SAAS,eAAA;IAAEC,MAAM,GAAAF,EAAA,CAAAE,MAAA;IAAEC,SAAS,GAAAH,EAAA,CAAAG,SAAA,CAAA;EACzD,IAAMC,aAAa,GAAGF,MAAM,GAAG;AAAEA,IAAAA,MAAM,EAAAA,MAAAA;AAAE,GAAA,GAAG,IAAI,CAAA;EAChD,IAAI,CAACD,SAAS,EAAE;AACd,IAAA,OAAO,EAAE,CAAA;AACV,GAAA;AACD,EAAA,IAAII,aAAO,CAACJ,SAAS,CAAC,EAAE;AACtB,IAAA,OAAOK,cAAM,CAACL,SAAS,EAAE,GAAG,EAAEG,aAAa,CAAC,CAAA;AAC7C,GAAA;AACD,EAAA,IAAIG,iBAAW,CAACN,SAAS,CAAC,EAAE;AAC1B,IAAA,OAAO,CAAAE,SAAS,KAAA,IAAA,IAATA,SAAS,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAATA,SAAS,CAAEK,yBAAyB,KAAI,WAAW,CAAA;AAC3D,GAAA;AACD,EAAA,IAAIC,gBAAU,CAACR,SAAS,CAAC,EAAE;AACzB,IAAA,OAAOK,cAAM,CAACL,SAAS,EAAE,OAAO,EAAEG,aAAa,CAAC,CAAA;AACjD,GAAA;AACD,EAAA,OAAOE,cAAM,CAACL,SAAS,EAAE,UAAU,EAAEG,aAAa,CAAC,CAAA;AACrD,CAAA;AAEM,SAAUM,iBAAiBA,CAACC,OAA2C,EAAA;;AAC3E,EAAA,IAAMC,cAAc,GAAG,CAAAZ,EAAA,GAAAa,4BAAsB,CAACF,OAAO,CAAC,MAAI,IAAA,IAAAX,EAAA,KAAA,KAAA,CAAA,GAAAA,EAAA,GAAA,EAAE,CAAA;AAC5D,EAAA,IAAMc,aAAa,GAAG,CAAAC,EAAA,GAAA,CAAAC,EAAA,GAACJ,cAAc,CAACK,KAAK,CAAC,sBAAsB,CAAE,MAAA,IAAA,IAAAD,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,EAAA,CAAG,CAAC,CAAC,MAAA,IAAA,IAAAD,EAAA,KAAA,KAAA,CAAA,GAAAA,EAAA,GAAI,EAAE,CAAA;AAE/E,EAAA,IAAI,kBAAkB,CAACG,IAAI,CAACJ,aAAa,CAAC,EAAE;IAC1C,OAAOK,iBAAS,CAACC,KAAK,CAAA;AACvB,GAAA,MAAM,IAAI,OAAO,CAACF,IAAI,CAACJ,aAAa,CAAC,IAAIO,sBAAc,CAACV,OAAO,CAAC,EAAE;IACjE,OAAOQ,iBAAS,CAACG,IAAI,CAAA;GACtB,MAAM,IAAI,MAAM,CAACJ,IAAI,CAACJ,aAAa,CAAC,EAAE;IACrC,OAAOK,iBAAS,CAACI,UAAU,CAAA;GAC5B,MAAM,IAAI,MAAM,CAACL,IAAI,CAACJ,aAAa,CAAC,EAAE;IACrC,OAAOK,iBAAS,CAACK,GAAG,CAAA;AACrB,GAAA,MAAM;IACL,OAAOL,iBAAS,CAACM,aAAa,CAAA;AAC/B,GAAA;AACH;;AC7BwB,SAAAC,qBAAqBA,CAACC,KAAY,EAAA;AAEtD,EAAA,IAAAC,SAAS,GAIPD,KAAK,UAJE;IACThB,OAAO,GAGLgB,KAAK,CAAAhB,OAHA;IACPkB,QAAQ,GAENF,KAAK,CAFCE,QAAA;IACRC,OAAO,GACLH,KAAK,QADA,CAAA;AAED,EAAA,IAAA1B,SAAS,GAAKU,OAAO,CAAAV,SAAZ,CAAA;AACjB,EAAA,IAAM8B,GAAG,GAAWlB,4BAAsB,CAACF,OAAO,CAAC,CAAA;AACnD,EAAA,IAAMqB,IAAI,GAAWC,6BAAuB,CAACtB,OAAO,CAAC,CAAA;AACrD;EACA,IAAMuB,MAAM,GAAGvB,OAAO,CAACuB,MAAM,IAAIvB,OAAO,CAACwB,OAAO,CAAA;AACxC,EAAA,IAAAC,UAAU,GAAeF,MAAM,CAAAE,UAArB;IAAEC,QAAQ,GAAKH,MAAM,CAAAG,QAAX,CAAA;AACtB,EAAA,IAAArC,EAAA,GAA4BsC,mCAAe,EAAE;IAA3CnC,SAAS,GAAAH,EAAA,CAAAG,SAAA;IAAEoC,UAAU,GAAAvC,EAAA,CAAAuC,UAAsB,CAAA;AACnD,EAAA,IAAMC,UAAU,GAAGnB,sBAAc,CAACV,OAAO,CAAC,CAAA;EAC1C,IAAM8B,cAAc,GAAGD,UAAU,GAAGrC,SAAS,CAACuC,aAAa,GAAIV,IAAI,IAAID,GAAI,CAAA;EAE3E,oBACEY,yBAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AACEhB,IAAAA,SAAS,EAAEiB,uBAAA,CAAAA,uBAAA,CAAA,EAAA,EACLC,KAAK,CAACC,OAAO,CAACnB,SAAS,CAAC,GAAGA,SAAS,GAAG,CAACA,SAAS,CAAC,EAAC,IAAA,CAAA,EAAA,CACvD,mCAAmC,EACnCC,QAAQ,GAAG,6CAA6C,GAAG,EAAE,UAC7DmB,IAAI,CAAC,GAAG,CAAE;AACZlB,IAAAA,OAAO,EAAE,UAACmB,CAAC,EAAA;MACTA,CAAC,CAACC,eAAe,EAAE,CAAA;MACnBpB,OAAO,CAACnB,OAAO,CAAC,CAAA;AAClB,KAAA;GAEAgC,eAAAA,yBAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AAAKhB,IAAAA,SAAS,EAAC,yCAAA;AAAyC,GAAA,eACtDe,yBAAA,CAAAC,aAAA,CAACO,oBAAM,EAAA;AACLvB,IAAAA,SAAS,EAAC,wDAAwD;AAClEwB,IAAAA,GAAG,EAAEhB,UAAW;AAChBiB,IAAAA,GAAG,EAAC,eAAe;AACnBC,IAAAA,KAAK,EAAC,MAAM;AACZC,IAAAA,MAAM,EAAC,MAAA;AAAM,GAEjB,CAAK,CACL,eAAAZ,yBAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AAAKhB,IAAAA,SAAS,EAAC,0CAAA;AAA0C,GAAA,eACvDe,yBAAA,CAAAC,aAAA,CAACY,cAAK,EAAA;AACJ5B,IAAAA,SAAS,EAAC,uDAAuD;IACjE6B,IAAI,EAAEC,wBAAe,CAACC,UAAW;IACjCC,KAAK,EAAEC,oBAAW,CAACC,cAAAA;GAElBzB,EAAAA,QAAQ,IAAIlC,SAAS,CAAC4D,OAClB,CACP,eAAApB,yBAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AAAKhB,IAAAA,SAAS,EAAC,mDAAA;AAAmD,GAAA,EAC/D,CAACY,UAAU,iBACVG,yBAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AAAKhB,IAAAA,SAAS,EAAE,8DAAA;AAA+D,GAAA,eAC7Ee,yBAAA,CAAAC,aAAA,CAACoB,kBAAI,EAAA;AACHP,IAAAA,IAAI,EAAE/C,iBAAiB,CAACC,OAAO,CAAE;IACjCsD,SAAS,EAAEC,kBAAU,CAACC,OAAQ;AAC9Bb,IAAAA,KAAK,EAAC,MAAM;AACZC,IAAAA,MAAM,EAAC,MAAA;AAAM,GAEjB,CAAK,CACN,eACDZ,yBAAA,CAAAC,aAAA,CAACY,cAAK,EAAA;AACJ5B,IAAAA,SAAS,EAAC,wDAAwD;IAClE6B,IAAI,EAAEC,wBAAe,CAACU,MAAO;IAC7BR,KAAK,EAAEC,oBAAW,CAACC,cAAAA;GAElBrB,EAAAA,cACI,CACJ,CACF,CACL,eAAAE,yBAAA,CAAAC,aAAA,CAACY,cAAK,EAAA;AACJ5B,IAAAA,SAAS,EAAC,uDAAuD;IACjE6B,IAAI,EAAEC,wBAAe,CAACW,SAAU;IAChCT,KAAK,EAAEC,oBAAW,CAACS,cAAAA;AAAe,GAAA,EAEjCvE,YAAY,CAAC;AAAEE,IAAAA,SAAS,WAAA;AAAEC,IAAAA,MAAM,EAAEqC,UAAU;AAAEpC,IAAAA,SAAS,EAAAA,SAAAA;AAAA,GAAE,CACrD,CACP,eAAAwC,yBAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AAAKhB,IAAAA,SAAS,EAAC,iDAAA;AAAiD,GAClE,CAAK,CAAC,CAAA;AAEV;;;;"}