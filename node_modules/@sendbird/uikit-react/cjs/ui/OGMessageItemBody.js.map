{"version":3,"file":"OGMessageItemBody.js","sources":["../../../src/ui/OGMessageItemBody/index.tsx"],"sourcesContent":["import './index.scss';\nimport React, {\n  ReactElement,\n  useContext,\n  useMemo,\n  useRef,\n} from 'react';\nimport type { UserMessage } from '@sendbird/chat/message';\n\nimport ImageRenderer from '../ImageRenderer';\nimport Icon, { IconTypes } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { getClassName, isEditedMessage } from '../../utils';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport TextFragment from '../../modules/Message/components/TextFragment';\nimport { tokenizeMessage } from '../../modules/Message/utils/tokens/tokenize';\nimport { OG_MESSAGE_BODY_CLASSNAME } from './consts';\n\ninterface Props {\n  className?: string | Array<string>;\n  message: UserMessage;\n  isByMe?: boolean;\n  mouseHover?: boolean;\n  isMentionEnabled?: boolean;\n  isReactionEnabled?: boolean;\n  onMessageHeightChange?: () => void;\n}\n\nexport default function OGMessageItemBody({\n  className,\n  message,\n  isByMe = false,\n  mouseHover = false,\n  isMentionEnabled = false,\n  isReactionEnabled = false,\n  onMessageHeightChange = () => { /* noop */ },\n}: Props): ReactElement {\n  const imageRef = useRef<HTMLDivElement>(null);\n  const { stringSet } = useContext(LocalizationContext);\n  const openOGUrl = (): void => {\n    if (message?.ogMetaData?.url) window.open(message?.ogMetaData?.url);\n  };\n  const isMessageMentioned = isMentionEnabled && message?.mentionedMessageTemplate?.length > 0 && message?.mentionedUsers?.length > 0;\n  const tokens = useMemo(() => {\n    if (isMessageMentioned) {\n      return tokenizeMessage({\n        mentionedUsers: message?.mentionedUsers,\n        messageText: message?.mentionedMessageTemplate,\n      });\n    }\n    return tokenizeMessage({\n      messageText: message?.message,\n    });\n  }, [message?.updatedAt]);\n  return (\n    <div className={getClassName([\n      className,\n      'sendbird-og-message-item-body',\n      isByMe ? 'outgoing' : 'incoming',\n      mouseHover ? 'mouse-hover' : '',\n      (isReactionEnabled && message?.reactions?.length > 0) ? 'reactions' : '',\n    ])}>\n      <Label\n        type={LabelTypography.BODY_1}\n        color={isByMe ? LabelColors.ONCONTENT_1 : LabelColors.ONBACKGROUND_1}\n      >\n        <div className={OG_MESSAGE_BODY_CLASSNAME}>\n          <TextFragment tokens={tokens} />\n          {\n            isEditedMessage(message) && (\n              <Label\n                className=\"sendbird-og-message-item-body__text-bubble__message\"\n                type={LabelTypography.BODY_1}\n                color={isByMe ? LabelColors.ONCONTENT_2 : LabelColors.ONBACKGROUND_2}\n              >\n                {` ${stringSet.MESSAGE_EDITED} `}\n              </Label>\n            )\n          }\n        </div>\n      </Label>\n      <div\n        ref={imageRef}\n        className={`sendbird-og-message-item-body__og-thumbnail\n          ${message?.ogMetaData?.defaultImage?.url ? '' : 'sendbird-og-message-item-body__og-thumbnail__empty'}\n        `}\n        onClick={openOGUrl}\n      >\n        <ImageRenderer\n          onLoad={onMessageHeightChange}\n          onError={() => {\n            try {\n              imageRef?.current?.classList?.add('sendbird-og-message-item-body__og-thumbnail__empty');\n            } catch (error) {\n              // do nothing\n            }\n          }}\n          className=\"sendbird-og-message-item-body__og-thumbnail__image\"\n          url={message?.ogMetaData?.defaultImage?.url || ''}\n          alt={message?.ogMetaData?.defaultImage?.alt}\n          // TODO: Change fixing width and height lengths\n          defaultComponent={(\n            <div className=\"sendbird-og-message-item-body__og-thumbnail__place-holder\">\n              <Icon\n                className=\"sendbird-og-message-item-body__og-thumbnail__place-holder__icon\"\n                type={IconTypes.THUMBNAIL_NONE}\n                width=\"56px\"\n                height=\"56px\"\n              />\n            </div>\n          )}\n        />\n      </div>\n      <div\n        className=\"sendbird-og-message-item-body__description\"\n        onClick={openOGUrl}\n      >\n        {message?.ogMetaData?.title && (\n          <Label\n            className=\"sendbird-og-message-item-body__description__title\"\n            type={LabelTypography.SUBTITLE_2}\n            color={LabelColors.ONBACKGROUND_1}\n          >\n            {message.ogMetaData.title}\n          </Label>\n        )}\n        {message?.ogMetaData?.description && (\n          <Label\n            className=\"sendbird-og-message-item-body__description__description\"\n            type={LabelTypography.BODY_2}\n            color={LabelColors.ONBACKGROUND_1}\n          >\n            {message.ogMetaData.description}\n          </Label>\n        )}\n        {message?.ogMetaData?.url && (\n          <Label\n            className=\"sendbird-og-message-item-body__description__url\"\n            type={LabelTypography.CAPTION_3}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {message.ogMetaData.url}\n          </Label>\n        )}\n      </div>\n      <div className=\"sendbird-og-message-item-body__cover\" />\n    </div>\n  );\n}\n"],"names":["OGMessageItemBody","_a","className","message","_p","isByMe","_q","mouseHover","_r","isMentionEnabled","_s","isReactionEnabled","_t","onMessageHeightChange","imageRef","useRef","stringSet","useContext","LocalizationContext","openOGUrl","ogMetaData","url","window","open","_b","isMessageMentioned","mentionedMessageTemplate","length","_c","mentionedUsers","tokens","useMemo","tokenizeMessage","messageText","updatedAt","React","createElement","getClassName","_d","reactions","Label","type","LabelTypography","BODY_1","color","LabelColors","ONCONTENT_1","ONBACKGROUND_1","OG_MESSAGE_BODY_CLASSNAME","TextFragment","isEditedMessage","ONCONTENT_2","ONBACKGROUND_2","concat","MESSAGE_EDITED","ref","_f","_e","defaultImage","onClick","ImageRenderer","onLoad","onError","current","classList","add","error","_h","_g","alt","_j","_k","defaultComponent","Icon","IconTypes","THUMBNAIL_NONE","width","height","_l","title","SUBTITLE_2","_m","description","BODY_2","_o","CAPTION_3"],"mappings":"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"}