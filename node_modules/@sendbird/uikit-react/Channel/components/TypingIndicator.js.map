{"version":3,"file":"TypingIndicator.js","sources":["../../../src/modules/Channel/components/TypingIndicator.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport {\n  GroupChannelHandler,\n  Member,\n  SendbirdGroupChat,\n} from '@sendbird/chat/groupChannel';\n\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport { uuidv4 } from '../../../utils/uuid';\nimport Label, { LabelTypography, LabelColors } from '../../../ui/Label';\nimport { useChannelContext } from '../context/ChannelProvider';\nimport useSendbirdStateContext from '../../../hooks/useSendbirdStateContext';\n\nexport interface TypingIndicatorTextProps {\n  members: Member[];\n}\n\nexport const TypingIndicatorText: React.FC<TypingIndicatorTextProps> = ({ members }: TypingIndicatorTextProps) => {\n  const { stringSet } = useContext(LocalizationContext);\n  if (!members || members.length === 0) {\n    return '';\n  }\n\n  if (members && members.length === 1) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__IS_TYPING}`;\n  }\n\n  if (members && members.length === 2) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__AND} ${members[1].nickname} ${stringSet.TYPING_INDICATOR__ARE_TYPING}`;\n  }\n\n  return stringSet.TYPING_INDICATOR__MULTIPLE_TYPING;\n};\n\nconst TypingIndicator: React.FC = () => {\n  const { channelUrl } = useChannelContext();\n  const globalStore = useSendbirdStateContext();\n  const sb = globalStore?.stores?.sdkStore?.sdk as SendbirdGroupChat;\n  const logger = globalStore?.config?.logger;\n  const [handlerId, setHandlerId] = useState(uuidv4());\n  const [typingMembers, setTypingMembers] = useState<Member[]>([]);\n\n  useEffect(() => {\n    if (sb?.groupChannel?.addGroupChannelHandler) {\n      sb.groupChannel.removeGroupChannelHandler(handlerId);\n      const newHandlerId = uuidv4();\n      const handler = new GroupChannelHandler({\n        onTypingStatusUpdated: (groupChannel) => {\n          // there is a possible warning in here - setState called after unmount\n          logger.info('Channel > Typing Indicator: onTypingStatusUpdated', groupChannel);\n          if (groupChannel.url === channelUrl) {\n            const members = groupChannel.getTypingUsers();\n            setTypingMembers(members);\n          }\n        },\n      });\n      sb.groupChannel.addGroupChannelHandler(newHandlerId, handler);\n      setHandlerId(newHandlerId);\n    }\n\n    return () => {\n      setTypingMembers([]);\n      if (sb?.groupChannel?.removeGroupChannelHandler) {\n        sb.groupChannel.removeGroupChannelHandler(handlerId);\n      }\n    };\n  }, [channelUrl]);\n\n  return (\n    <Label\n      className=\"sendbird-conversation__footer__typing-indicator__text\"\n      type={LabelTypography.CAPTION_2}\n      color={LabelColors.ONBACKGROUND_2}\n    >\n      <TypingIndicatorText members={typingMembers} />\n    </Label>\n  );\n};\n\nexport default TypingIndicator;\n"],"names":["TypingIndicatorText","_a","members","stringSet","useContext","LocalizationContext","length","concat","nickname","TYPING_INDICATOR__IS_TYPING","TYPING_INDICATOR__AND","TYPING_INDICATOR__ARE_TYPING","TYPING_INDICATOR__MULTIPLE_TYPING","TypingIndicator","channelUrl","useChannelContext","globalStore","useSendbirdStateContext","sb","_b","stores","sdkStore","sdk","logger","_c","config","_d","useState","uuidv4","handlerId","setHandlerId","_e","typingMembers","setTypingMembers","useEffect","groupChannel","addGroupChannelHandler","removeGroupChannelHandler","newHandlerId","handler","GroupChannelHandler","onTypingStatusUpdated","info","url","getTypingUsers","React","createElement","Label","className","type","LabelTypography","CAPTION_2","color","LabelColors","ONBACKGROUND_2"],"mappings":"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"}