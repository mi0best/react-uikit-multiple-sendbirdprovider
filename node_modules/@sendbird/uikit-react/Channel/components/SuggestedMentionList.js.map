{"version":3,"file":"SuggestedMentionList.js","sources":["../../../src/modules/Channel/components/SuggestedMentionList/SuggestedUserMentionItem.tsx","../../../src/modules/Channel/components/SuggestedMentionList/index.tsx"],"sourcesContent":["import React, { useContext, useEffect, useMemo, useRef } from 'react';\nimport type { Member } from '@sendbird/chat/groupChannel';\nimport type { User } from '@sendbird/chat';\n\nimport Avatar from '../../../../ui/Avatar';\nimport Label, { LabelTypography, LabelColors } from '../../../../ui/Label';\nimport { LocalizationContext } from '../../../../lib/LocalizationContext';\nimport { MentionItemUIEvent } from '../../../..';\nimport uuidv4 from '../../../../utils/uuid';\n\ninterface SuggestedUserMentionItemProps {\n  member: User | Member;\n  isFocused?: boolean;\n  parentScrollRef?: React.RefObject<HTMLDivElement>;\n  onClick?: (props: MentionItemUIEvent) => void;\n  onMouseOver?: (props: MentionItemUIEvent) => void;\n  onMouseMove?: (props: MentionItemUIEvent) => void;\n  renderUserMentionItem?: (props: { user: User | Member }) => JSX.Element;\n}\n\nfunction SuggestedUserMentionItem(props: SuggestedUserMentionItemProps): JSX.Element {\n  const {\n    member,\n    isFocused = false,\n    parentScrollRef,\n    onClick,\n    onMouseOver,\n    onMouseMove,\n    renderUserMentionItem,\n  } = props;\n  const scrollRef = useRef<HTMLDivElement>(null);\n  const { stringSet = {} } = useContext(LocalizationContext);\n  useEffect(() => {\n    if (isFocused && parentScrollRef?.current != null && scrollRef?.current != null\n      && (parentScrollRef.current.scrollTop >= scrollRef.current.offsetTop\n        || parentScrollRef.current.scrollTop + parentScrollRef.current.clientHeight <= scrollRef.current.offsetTop\n      )) {\n      scrollRef.current.scrollIntoView({ block: 'nearest', inline: 'nearest' });\n    }\n  }, [isFocused]);\n  const customMentionItem = useMemo(() => {\n    if (renderUserMentionItem) {\n      return (\n        <div\n          className=\"sendbird-mention-suggest-list__user-item\"\n          onClick={(event) => onClick?.({ event, member: (member as Member), itemRef: scrollRef })}\n          onMouseOver={(event) => onMouseOver?.({ event, member: (member as Member), itemRef: scrollRef })}\n          onMouseMove={(event) => onMouseMove?.({ event, member: (member as Member), itemRef: scrollRef })}\n          key={member?.userId || uuidv4()}\n          ref={scrollRef}\n        >\n          {renderUserMentionItem({ user: member })}\n        </div>\n      );\n    }\n  }, [renderUserMentionItem]);\n  if (customMentionItem) {\n    return customMentionItem;\n  }\n  return (\n    <div\n      className={`sendbird-mention-suggest-list__user-item ${isFocused ? 'focused' : ''}`}\n      onClick={(event) => onClick?.({ event, member: (member as Member), itemRef: scrollRef })}\n      onMouseOver={(event) => onMouseOver?.({ event, member: (member as Member), itemRef: scrollRef })}\n      onMouseMove={(event) => onMouseMove?.({ event, member: (member as Member), itemRef: scrollRef })}\n      key={member?.userId || uuidv4()}\n      ref={scrollRef}\n    >\n      <Avatar\n        className=\"sendbird-mention-suggest-list__user-item__avatar\"\n        src={member?.profileUrl}\n        alt=\"user-profile\"\n        width=\"24px\"\n        height=\"24px\"\n      />\n      <Label\n        className=\"sendbird-mention-suggest-list__user-item__nickname\"\n        type={LabelTypography.SUBTITLE_2}\n        color={member?.nickname ? LabelColors.ONBACKGROUND_1 : LabelColors.ONBACKGROUND_3}\n      >\n        {member?.nickname || stringSet?.MENTION_NAME__NO_NAME}\n      </Label>\n      <Label\n        className=\"sendbird-mention-suggest-list__user-item__user-id\"\n        type={LabelTypography.SUBTITLE_2}\n        color={LabelColors.ONBACKGROUND_2}\n      >\n        {member?.userId}\n      </Label>\n    </div>\n  );\n}\n\nexport default SuggestedUserMentionItem;\n","import './index.scss';\nimport React, { useState, useEffect, useContext, useRef } from 'react';\nimport type { User } from '@sendbird/chat';\nimport type { Member } from '@sendbird/chat/groupChannel';\n\nimport Label, { LabelTypography, LabelColors } from '../../../../ui/Label';\nimport Icon, { IconTypes, IconColors } from '../../../../ui/Icon';\nimport SuggestedUserMentionItem from './SuggestedUserMentionItem';\nimport { useChannelContext } from '../../context/ChannelProvider';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\nimport { LocalizationContext } from '../../../../lib/LocalizationContext';\nimport { MAX_USER_MENTION_COUNT, MAX_USER_SUGGESTION_COUNT, USER_MENTION_TEMP_CHAR } from '../../context/const';\nimport { MessageInputKeys } from '../../../../ui/MessageInput/const';\nimport uuidv4 from '../../../../utils/uuid';\nimport { useThreadContext } from '../../../Thread/context/ThreadProvider';\n\nexport interface SuggestedMentionListProps {\n  className?: string;\n  targetNickname: string;\n  memberListQuery?: Record<string, string>;\n  onUserItemClick?: (member: User) => void;\n  onFocusItemChange?: (member: User) => void;\n  onFetchUsers?: (users: Array<User>) => void;\n  renderUserMentionItem?: (props: { user: User }) => JSX.Element;\n  ableAddMention: boolean;\n  maxMentionCount?: number;\n  maxSuggestionCount?: number;\n  inputEvent?: React.KeyboardEvent<HTMLDivElement>;\n}\n\nconst DEBOUNCING_TIME = 300;\n\nfunction SuggestedMentionList(props: SuggestedMentionListProps): JSX.Element {\n  const {\n    className,\n    targetNickname = '',\n    // memberListQuery,\n    onUserItemClick,\n    onFocusItemChange,\n    onFetchUsers,\n    renderUserMentionItem,\n    inputEvent,\n    ableAddMention = true,\n    maxMentionCount = MAX_USER_MENTION_COUNT,\n    maxSuggestionCount = MAX_USER_SUGGESTION_COUNT,\n  } = props;\n  const currentGroupChannel = useChannelContext?.()?.currentGroupChannel;\n  const currentChannel = useThreadContext?.()?.currentChannel;\n  const channelInstance = currentGroupChannel || currentChannel;\n  const { config, stores } = useSendbirdStateContext();\n  const { logger } = config;\n  const currentUserId = stores?.sdkStore?.sdk?.currentUser?.userId || '';\n  const scrollRef = useRef(null);\n  const { stringSet } = useContext(LocalizationContext);\n  const [timer, setTimer] = useState(null);\n  const [searchString, setSearchString] = useState('');\n  const [lastSearchString, setLastSearchString] = useState('');\n  const [currentUser, setCurrentUser] = useState<User>(null);\n  const [currentMemberList, setCurrentMemberList] = useState<Array<Member>>([]);\n\n  useEffect(() => {\n    clearTimeout(timer);\n    setTimer(\n      setTimeout(() => {\n        setSearchString(targetNickname);\n      }, DEBOUNCING_TIME),\n    );\n  }, [targetNickname]);\n\n  useEffect(() => {\n    if (inputEvent?.key === MessageInputKeys.Enter) {\n      if (currentMemberList.length > 0) {\n        onUserItemClick(currentUser);\n      }\n    }\n    if (inputEvent?.key === MessageInputKeys.ArrowUp) {\n      const currentUserIndex = currentMemberList.findIndex((member) => (\n        member?.userId === currentUser?.userId\n      ));\n      if (0 < currentUserIndex) {\n        setCurrentUser(currentMemberList[currentUserIndex - 1]);\n        onFocusItemChange(currentMemberList[currentUserIndex - 1]);\n      }\n    }\n    if (inputEvent?.key === MessageInputKeys.ArrowDown) {\n      const currentUserIndex = currentMemberList.findIndex((member) => (\n        member?.userId === currentUser?.userId\n      ));\n      if (currentUserIndex < currentMemberList.length - 1) {\n        setCurrentUser(currentMemberList[currentUserIndex + 1]);\n        onFocusItemChange(currentMemberList[currentUserIndex + 1]);\n      }\n    }\n  }, [inputEvent]);\n\n  /* Fetch member list */\n  useEffect(() => {\n    if (!channelInstance?.createMemberListQuery) {\n      logger.warning('SuggestedMentionList: Creating member list query failed');\n      return;\n    }\n    if (lastSearchString && searchString.indexOf(lastSearchString) === 0 && currentMemberList.length === 0) {\n      // Don't need to request query again\n      return;\n    }\n\n    const query = channelInstance?.createMemberListQuery({\n      limit: maxSuggestionCount + 1, // because current user could be included\n      nicknameStartsWithFilter: searchString.slice(USER_MENTION_TEMP_CHAR.length),\n    });\n    // Add member list query for customization\n    query.next()\n      .then((memberList) => {\n        const suggestingMembers = memberList\n          .filter((member) => currentUserId !== member?.userId)\n          .slice(0, maxSuggestionCount);\n        if (suggestingMembers.length < 1) {\n          logger.info('SuggestedMentionList: Fetched member list is empty');\n        } else {\n          logger.info('SuggestedMentionList: Fetching member list succeeded', { memberListQuery: query, memberList: suggestingMembers });\n          setCurrentUser(suggestingMembers[0]);\n        }\n        setLastSearchString(searchString);\n        onFetchUsers(suggestingMembers);\n        setCurrentMemberList(suggestingMembers);\n      })\n      .catch((error) => {\n        if (error) {\n          logger.error('SuggestedMentionList: Fetching member list failed', error);\n        }\n      });\n  }, [channelInstance?.url, searchString]);\n\n  if (!ableAddMention && currentMemberList.length === 0) {\n    return null;\n  }\n\n  return (\n    <div\n      className={`sendbird-mention-suggest-list ${className}`}\n      key=\"sendbird-mention-suggest-list\"\n      ref={scrollRef}\n    >\n      {\n        ableAddMention && currentMemberList?.map((member) => (\n          <SuggestedUserMentionItem\n            key={member?.userId || uuidv4()}\n            member={member}\n            isFocused={member?.userId === currentUser?.userId}\n            parentScrollRef={scrollRef}\n            onClick={({ member }) => {\n              onUserItemClick(member);\n            }}\n            onMouseOver={({ member }) => {\n              setCurrentUser(member);\n            }}\n            renderUserMentionItem={renderUserMentionItem}\n          />\n        ))\n      }\n      {\n        !ableAddMention && (\n          <div className=\"sendbird-mention-suggest-list__notice-item\">\n            <Icon\n              className=\"sendbird-mention-suggest-list__notice-item__icon\"\n              type={IconTypes.INFO}\n              fillColor={IconColors.ON_BACKGROUND_2}\n              width=\"20px\"\n              height=\"20px\"\n            />\n            <Label\n              className=\"sendbird-mention-suggest-list__notice-item__text\"\n              type={LabelTypography.SUBTITLE_2}\n              color={LabelColors.ONBACKGROUND_2}\n            >\n              {stringSet.MENTION_COUNT__OVER_LIMIT.replace('%d', maxMentionCount)}\n            </Label>\n          </div>\n        )\n      }\n    </div>\n  );\n}\n\nexport default SuggestedMentionList;\n"],"names":["SuggestedUserMentionItem","props","member","_a","isFocused","parentScrollRef","onClick","onMouseOver","onMouseMove","renderUserMentionItem","scrollRef","useRef","_b","useContext","LocalizationContext","stringSet","useEffect","current","scrollTop","offsetTop","clientHeight","scrollIntoView","block","inline","customMentionItem","useMemo","React","createElement","className","event","itemRef","key","userId","uuidv4","ref","user","concat","Avatar","src","profileUrl","alt","width","height","Label","type","LabelTypography","SUBTITLE_2","color","nickname","LabelColors","ONBACKGROUND_1","ONBACKGROUND_3","MENTION_NAME__NO_NAME","ONBACKGROUND_2","DEBOUNCING_TIME","SuggestedMentionList","_f","targetNickname","onUserItemClick","onFocusItemChange","onFetchUsers","inputEvent","_g","ableAddMention","_h","maxMentionCount","MAX_USER_MENTION_COUNT","_j","maxSuggestionCount","MAX_USER_SUGGESTION_COUNT","currentGroupChannel","useChannelContext","currentChannel","useThreadContext","channelInstance","_k","useSendbirdStateContext","config","stores","logger","currentUserId","_e","_c","sdkStore","sdk","_d","currentUser","_l","useState","timer","setTimer","_m","searchString","setSearchString","_o","lastSearchString","setLastSearchString","_p","setCurrentUser","_q","currentMemberList","setCurrentMemberList","clearTimeout","setTimeout","MessageInputKeys","Enter","length","ArrowUp","currentUserIndex","findIndex","ArrowDown","createMemberListQuery","warning","indexOf","query","limit","nicknameStartsWithFilter","slice","USER_MENTION_TEMP_CHAR","next","then","memberList","suggestingMembers","filter","info","memberListQuery","catch","error","url","map","Icon","IconTypes","INFO","fillColor","IconColors","ON_BACKGROUND_2","MENTION_COUNT__OVER_LIMIT","replace"],"mappings":"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"}