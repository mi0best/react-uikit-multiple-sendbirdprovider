{"version":3,"file":"index-494f9e79.js","sources":["../src/hooks/useDebounce.ts","../src/hooks/useHandleOnScrollCallback/index.ts"],"sourcesContent":["import { useEffect, useRef } from 'react';\n\nexport function useDebounce<T extends(...args: any[]) => void>(callback: T, delay: number): T {\n  const timeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  useEffect(() => {\n    // Cleanup the timeout on unmount\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, []);\n\n  function debounceFunction(...args: Parameters<T>) {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    timeoutRef.current = setTimeout(() => {\n      callback(...args);\n    }, delay);\n  }\n\n  return debounceFunction as T;\n}\n","import React, { useCallback } from 'react';\nimport { SCROLL_BUFFER } from '../../utils/consts';\nimport { useDebounce } from '../useDebounce';\n\nconst DELAY = 500;\n\nexport interface UseHandleOnScrollCallbackProps {\n  hasMore: boolean;\n  hasNext?: boolean;\n  onScroll(callback: () => void): void;\n  scrollRef: React.RefObject<HTMLDivElement>;\n  setShowScrollDownButton?: React.Dispatch<React.SetStateAction<boolean>>;\n  setIsScrolled?: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nexport function calcScrollBottom(scrollHeight: number, scrollTop: number): number {\n  return scrollHeight - scrollTop;\n}\n\nexport function useHandleOnScrollCallback({\n  hasMore,\n  hasNext,\n  onScroll,\n  scrollRef,\n  setShowScrollDownButton,\n}: UseHandleOnScrollCallbackProps): () => void {\n  const scrollCb = useCallback(() => {\n    const element = scrollRef?.current;\n    if (element == null) {\n      return;\n    }\n\n    const {\n      scrollTop,\n      scrollHeight,\n      clientHeight,\n    } = element;\n    // https://sendbird.atlassian.net/browse/SBISSUE-11759\n    // the edge case where channel is inside a page that already has scroll\n    // scrollintoView will move the whole page, which we dont want\n    const scrollBottom = calcScrollBottom(scrollHeight, scrollTop);\n    // even if there is more to fetch or not,\n    // we still have to show the scroll to bottom button\n    if (typeof setShowScrollDownButton === 'function') {\n      setShowScrollDownButton(scrollHeight > scrollTop + clientHeight + 1);\n    }\n    if (hasMore && scrollTop < SCROLL_BUFFER) {\n      onScroll(() => {\n        // sets the scroll position to the bottom of the new messages\n        element.scrollTop = element.scrollHeight - scrollBottom;\n      });\n    }\n    if (hasNext) {\n      onScroll(() => {\n        // sets the scroll position to the top of the new messages\n        element.scrollTop = scrollTop - (scrollHeight - element.scrollHeight);\n      });\n    }\n  }, [\n    setShowScrollDownButton,\n    hasMore,\n    onScroll,\n    scrollRef,\n  ]);\n\n  return useDebounce(scrollCb, DELAY);\n}\n"],"names":["useDebounce","callback","delay","timeoutRef","useRef","useEffect","current","clearTimeout","debounceFunction","args","_i","arguments","length","setTimeout","apply","DELAY","calcScrollBottom","scrollHeight","scrollTop","useHandleOnScrollCallback","_a","hasMore","hasNext","onScroll","scrollRef","setShowScrollDownButton","scrollCb","useCallback","element","clientHeight","scrollBottom","SCROLL_BUFFER"],"mappings":"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"}