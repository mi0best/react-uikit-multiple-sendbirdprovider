{"version":3,"file":"ParentMessageInfo.js","sources":["../../../src/modules/Thread/components/ParentMessageInfo/index.tsx"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from 'react';\nimport format from 'date-fns/format';\nimport { FileMessage } from '@sendbird/chat/message';\n\nimport './index.scss';\nimport RemoveMessage from '../RemoveMessageModal';\nimport ParentMessageInfoItem from './ParentMessageInfoItem';\n\nimport { getSenderName, SendableMessageType } from '../../../../utils';\nimport { getIsReactionEnabled } from '../../../../utils/getIsReactionEnabled';\nimport { useLocalization } from '../../../../lib/LocalizationContext';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\nimport { useThreadContext } from '../../context/ThreadProvider';\nimport { UserProfileContext } from '../../../../lib/UserProfileContext';\nimport SuggestedMentionList from '../../../Channel/components/SuggestedMentionList';\n\nimport Avatar from '../../../../ui/Avatar';\nimport Label, { LabelTypography, LabelColors } from '../../../../ui/Label';\nimport FileViewer from '../../../../ui/FileViewer';\nimport MessageItemMenu from '../../../../ui/MessageItemMenu';\nimport MessageItemReactionMenu from '../../../../ui/MessageItemReactionMenu';\nimport ContextMenu, { MenuItems } from '../../../../ui/ContextMenu';\nimport ConnectedUserProfile from '../../../../ui/UserProfile';\nimport MessageInput from '../../../../ui/MessageInput';\nimport { MessageInputKeys } from '../../../../ui/MessageInput/const';\nimport { Role } from '../../../../lib/types';\nimport { useMediaQueryContext } from '../../../../lib/MediaQueryContext';\nimport useLongPress from '../../../../hooks/useLongPress';\nimport MobileMenu from '../../../../ui/MobileMenu';\nimport { useDirtyGetMentions } from '../../../Message/hooks/useDirtyGetMentions';\n\nexport interface ParentMessageInfoProps {\n  className?: string;\n}\n\nexport default function ParentMessageInfo({\n  className,\n}: ParentMessageInfoProps): React.ReactElement {\n  const { stores, config } = useSendbirdStateContext();\n  const {\n    isMentionEnabled,\n    isReactionEnabled,\n    replyType,\n    isOnline,\n    userMention,\n    logger,\n  } = config;\n  const userId = stores.userStore.user?.userId ?? '';\n  const { dateLocale } = useLocalization();\n  const {\n    currentChannel,\n    parentMessage,\n    allThreadMessages,\n    emojiContainer,\n    toggleReaction,\n    updateMessage,\n    deleteMessage,\n    onMoveToParentMessage,\n    onHeaderActionClick,\n    isMuted,\n    isChannelFrozen,\n  } = useThreadContext();\n  const { isMobile } = useMediaQueryContext();\n\n  const [showRemove, setShowRemove] = useState(false);\n  const [supposedHover, setSupposedHover] = useState(false);\n  const [showFileViewer, setShowFileViewer] = useState(false);\n  const usingReaction = getIsReactionEnabled({\n    globalLevel: isReactionEnabled,\n    isSuper: currentChannel.isSuper,\n    isBroadcast: currentChannel.isBroadcast,\n  });\n  const isByMe = userId === parentMessage.sender.userId;\n\n  // Mobile\n  const mobileMenuRef = useRef(null);\n  const [showMobileMenu, setShowMobileMenu] = useState(false);\n  const longPress = useLongPress({\n    onLongPress: () => {\n      if (isMobile) {\n        setShowMobileMenu(true);\n      }\n    },\n  }, {\n    shouldPreventDefault: false,\n  });\n\n  // Edit message\n  const [showEditInput, setShowEditInput] = useState(false);\n  const disabled = !isOnline || isMuted || isChannelFrozen && !(currentChannel?.myRole === Role.OPERATOR);\n\n  // Mention\n  const editMessageInputRef = useRef(null);\n  const [mentionNickname, setMentionNickname] = useState('');\n  const [mentionedUsers, setMentionedUsers] = useState([]);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [messageInputEvent, setMessageInputEvent] = useState(null);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [mentionSuggestedUsers, setMentionSuggestedUsers] = useState([]);\n  const displaySuggestedMentionList = isOnline\n    && isMentionEnabled\n    && mentionNickname.length > 0\n    && !isMuted\n    && !(isChannelFrozen && !(currentChannel.myRole === Role.OPERATOR));\n\n  const mentionNodes = useDirtyGetMentions({ ref: editMessageInputRef }, { logger });\n  const ableMention = mentionNodes?.length < userMention?.maxMentionCount;\n\n  useEffect(() => {\n    setMentionedUsers(mentionedUsers.filter(({ userId }) => {\n      const i = mentionedUserIds.indexOf(userId);\n      if (i < 0) {\n        return false;\n      } else {\n        mentionedUserIds.splice(i, 1);\n        return true;\n      }\n    }));\n  }, [mentionedUserIds]);\n\n  // User Profile\n  const avatarRef = useRef(null);\n  const { disableUserProfile, renderUserProfile } = useContext(UserProfileContext);\n\n  if (showEditInput && parentMessage?.isUserMessage?.()) {\n    return (\n      <>\n        {\n          displaySuggestedMentionList && (\n            <SuggestedMentionList\n              className=\"parent-message-info--suggested-mention-list\"\n              targetNickname={mentionNickname}\n              inputEvent={messageInputEvent}\n              // renderUserMentionItem={renderUserMentionItem}\n              onUserItemClick={(user) => {\n                if (user) {\n                  setMentionedUsers([...mentionedUsers, user]);\n                }\n                setMentionNickname('');\n                setSelectedUser(user);\n                setMessageInputEvent(null);\n              }}\n              onFocusItemChange={() => {\n                setMessageInputEvent(null);\n              }}\n              onFetchUsers={(users) => {\n                setMentionSuggestedUsers(users);\n              }}\n              ableAddMention={ableMention}\n              maxMentionCount={userMention?.maxMentionCount}\n              maxSuggestionCount={userMention?.maxSuggestionCount}\n            />\n          )\n        }\n        <MessageInput\n          channel={currentChannel}\n          isEdit\n          disabled={disabled}\n          ref={editMessageInputRef}\n          mentionSelectedUser={selectedUser}\n          isMentionEnabled={isMentionEnabled}\n          message={parentMessage}\n          onStartTyping={() => {\n            currentChannel?.startTyping?.();\n          }}\n          onUpdateMessage={({ messageId, message, mentionTemplate }) => {\n            updateMessage({\n              messageId,\n              message,\n              mentionedUsers,\n              mentionTemplate,\n            });\n            setShowEditInput(false);\n            currentChannel?.endTyping?.();\n          }}\n          onCancelEdit={() => {\n            setMentionNickname('');\n            setMentionedUsers([]);\n            setMentionedUserIds([]);\n            setMentionSuggestedUsers([]);\n            setShowEditInput(false);\n            currentChannel?.endTyping?.();\n          }}\n          onUserMentioned={(user) => {\n            if (selectedUser?.userId === user?.userId) {\n              setSelectedUser(null);\n              setMentionNickname('');\n            }\n          }}\n          onMentionStringChange={(mentionText) => {\n            setMentionNickname(mentionText);\n          }}\n          onMentionedUserIdsUpdated={(userIds) => {\n            setMentionedUserIds(userIds);\n          }}\n          onKeyDown={(e) => {\n            if (displaySuggestedMentionList && mentionSuggestedUsers?.length > 0\n              && ((e.key === MessageInputKeys.Enter && ableMention) || e.key === MessageInputKeys.ArrowUp || e.key === MessageInputKeys.ArrowDown)\n            ) {\n              setMessageInputEvent(e);\n              return true;\n            }\n            return false;\n          }}\n        />\n      </>\n    );\n  }\n\n  return (\n    <div\n      className={`sendbird-parent-message-info ${className}`}\n      {...(isMobile) ? { ...longPress } : {}}\n      ref={mobileMenuRef}\n    >\n      <ContextMenu\n        menuTrigger={(toggleDropdown) => (\n          <Avatar\n            className=\"sendbird-parent-message-info__sender\"\n            ref={avatarRef}\n            src={\n              currentChannel?.members?.find((m) => m?.userId === parentMessage?.sender?.userId)?.profileUrl\n              || parentMessage?.sender?.profileUrl\n            }\n            alt=\"thread message sender\"\n            width=\"40px\"\n            height=\"40px\"\n            onClick={() => {\n              if (!disableUserProfile) {\n                toggleDropdown();\n              }\n            }}\n          />\n        )}\n        menuItems={(closeDropdown) => (\n          <MenuItems\n            parentRef={avatarRef}\n            parentContainRef={avatarRef}\n            closeDropdown={closeDropdown}\n            style={{ paddingTop: '0px', paddingBottom: '0px' }}\n          >\n            {renderUserProfile\n              ? renderUserProfile({ user: parentMessage?.sender, close: closeDropdown, currentUserId: userId })\n              : (\n                <ConnectedUserProfile\n                  user={parentMessage?.sender}\n                  currentUserId={userId}\n                  onSuccess={closeDropdown}\n                />\n              )}\n          </MenuItems>\n        )}\n      />\n      <div className=\"sendbird-parent-message-info__content\">\n        <div className=\"sendbird-parent-message-info__content__info\">\n          <Label\n            className={`sendbird-parent-message-info__content__info__sender-name${usingReaction ? '--use-reaction' : ''}`}\n            type={LabelTypography.CAPTION_2}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {\n              currentChannel?.members?.find((member) => member?.userId === parentMessage?.sender?.userId)\n                ?.nickname || getSenderName?.(parentMessage as SendableMessageType)\n            }\n          </Label>\n          <Label\n            className=\"sendbird-parent-message-info__content__info__sent-at\"\n            type={LabelTypography.CAPTION_3}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {format(parentMessage?.createdAt || 0, 'p', { locale: dateLocale })}\n          </Label>\n        </div>\n        {/* message content body */}\n        <ParentMessageInfoItem\n          message={parentMessage}\n          showFileViewer={setShowFileViewer}\n        />\n      </div>\n      {/* context menu */}\n      {!isMobile && (\n        <MessageItemMenu\n          className={`sendbird-parent-message-info__context-menu ${usingReaction ? 'use-reaction' : ''} ${supposedHover ? 'sendbird-mouse-hover' : ''}`}\n          channel={currentChannel}\n          message={parentMessage}\n          isByMe={userId === parentMessage?.sender?.userId}\n          disableDeleteMessage={allThreadMessages.length > 0}\n          replyType={replyType}\n          showEdit={setShowEditInput}\n          showRemove={setShowRemove}\n          setSupposedHover={setSupposedHover}\n          onMoveToParentMessage={() => {\n            onMoveToParentMessage({ message: parentMessage, channel: currentChannel });\n          }}\n        />\n      )}\n      {(usingReaction && !isMobile) && (\n        <MessageItemReactionMenu\n          className={`sendbird-parent-message-info__reaction-menu ${supposedHover ? 'sendbird-mouse-hover' : ''}`}\n          message={parentMessage}\n          userId={userId}\n          emojiContainer={emojiContainer}\n          toggleReaction={toggleReaction}\n          setSupposedHover={setSupposedHover}\n        />\n      )}\n      {showRemove && (\n        <RemoveMessage\n          onCancel={() => setShowRemove(false)}\n          onSubmit={() => {\n            onHeaderActionClick?.();\n          }}\n          message={parentMessage}\n        />\n      )}\n      {showFileViewer && (\n        <FileViewer\n          message={parentMessage as FileMessage}\n          onClose={() => setShowFileViewer(false)}\n          onDelete={() => {\n            deleteMessage(parentMessage)\n              .then(() => {\n                setShowFileViewer(false);\n              });\n          }}\n        />\n      )}\n      {showMobileMenu && (\n        <MobileMenu\n          parentRef={mobileMenuRef}\n          channel={currentChannel}\n          message={parentMessage}\n          userId={userId}\n          replyType={replyType}\n          hideMenu={() => {\n            setShowMobileMenu(false);\n          }}\n          deleteMessage={deleteMessage}\n          deleteMenuState={\n            allThreadMessages?.length === 0\n              ? 'ACTIVE'\n              : 'HIDE'\n          }\n          isReactionEnabled={usingReaction}\n          isByMe={isByMe}\n          emojiContainer={emojiContainer}\n          showEdit={setShowEditInput}\n          showRemove={setShowRemove}\n          toggleReaction={toggleReaction}\n          isOpenedFromThread\n        />\n      )}\n    </div>\n  );\n}\n"],"names":["ParentMessageInfo","_a","className","_h","useSendbirdStateContext","stores","config","isMentionEnabled","isReactionEnabled","replyType","isOnline","userMention","logger","userId","_c","_b","userStore","user","dateLocale","useLocalization","_j","useThreadContext","currentChannel","parentMessage","allThreadMessages","emojiContainer","toggleReaction","updateMessage","deleteMessage","onMoveToParentMessage","onHeaderActionClick","isMuted","isChannelFrozen","isMobile","useMediaQueryContext","_k","useState","showRemove","setShowRemove","_l","supposedHover","setSupposedHover","_m","showFileViewer","setShowFileViewer","usingReaction","getIsReactionEnabled","globalLevel","isSuper","isBroadcast","isByMe","sender","mobileMenuRef","useRef","_o","showMobileMenu","setShowMobileMenu","longPress","useLongPress","onLongPress","shouldPreventDefault","_p","showEditInput","setShowEditInput","disabled","myRole","Role","OPERATOR","editMessageInputRef","_q","mentionNickname","setMentionNickname","_r","mentionedUsers","setMentionedUsers","_s","mentionedUserIds","setMentionedUserIds","_t","messageInputEvent","setMessageInputEvent","_u","selectedUser","setSelectedUser","_v","mentionSuggestedUsers","setMentionSuggestedUsers","displaySuggestedMentionList","length","mentionNodes","useDirtyGetMentions","ref","ableMention","maxMentionCount","useEffect","filter","i","indexOf","splice","avatarRef","_w","useContext","UserProfileContext","disableUserProfile","renderUserProfile","_d","isUserMessage","call","React","createElement","Fragment","SuggestedMentionList","targetNickname","inputEvent","onUserItemClick","__spreadArray","onFocusItemChange","onFetchUsers","users","ableAddMention","maxSuggestionCount","MessageInput","channel","isEdit","mentionSelectedUser","message","onStartTyping","startTyping","onUpdateMessage","messageId","mentionTemplate","endTyping","onCancelEdit","onUserMentioned","onMentionStringChange","mentionText","onMentionedUserIdsUpdated","userIds","onKeyDown","e","key","MessageInputKeys","Enter","ArrowUp","ArrowDown","_extends","concat","__assign","ContextMenu","menuTrigger","toggleDropdown","Avatar","src","members","find","m","profileUrl","alt","width","height","onClick","menuItems","closeDropdown","MenuItems","parentRef","parentContainRef","style","paddingTop","paddingBottom","close","currentUserId","ConnectedUserProfile","onSuccess","Label","type","LabelTypography","CAPTION_2","color","LabelColors","ONBACKGROUND_2","_f","_e","member","nickname","getSenderName","CAPTION_3","format","createdAt","locale","ParentMessageInfoItem","MessageItemMenu","_g","disableDeleteMessage","showEdit","MessageItemReactionMenu","RemoveMessage","onCancel","onSubmit","FileViewer","onClose","onDelete","then","MobileMenu","hideMenu","deleteMenuState","isOpenedFromThread"],"mappings":"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"}