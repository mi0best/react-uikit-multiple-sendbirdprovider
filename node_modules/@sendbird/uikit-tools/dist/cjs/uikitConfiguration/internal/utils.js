"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isRawSBUConfigPayload = exports.getConfigsByPriority = void 0;
const isSameType_js_1 = require("../../utils/isSameType.js");
/**
 * @param localConfigs Set directly in code level. It has higher priority than remote ones
 * @param remoteConfigs Set by Feature Config setting in Dashboard
 * @returns
 */
function getConfigsByPriority(localConfigs, remoteConfigs) {
    // copy remoteConfigs to prevent mutation
    const prioritizedConfigs = Object.assign({}, remoteConfigs);
    Object.keys(localConfigs).forEach((key) => {
        if (Object.prototype.hasOwnProperty.call(prioritizedConfigs, key) &&
            (0, isSameType_js_1.isSameType)(localConfigs[key], prioritizedConfigs[key])) {
            if (typeof localConfigs[key] === 'object') {
                // Recursively call getConfigsByPriority only when the value of the key is Object
                prioritizedConfigs[key] = getConfigsByPriority(localConfigs[key], prioritizedConfigs[key]);
            }
            else {
                prioritizedConfigs[key] = localConfigs[key];
            }
        }
    });
    return prioritizedConfigs;
}
exports.getConfigsByPriority = getConfigsByPriority;
/**
 * @param json UIKitConfiguration's json
 * @returns boolean
 * */
function isRawSBUConfigPayload(json) {
    return typeof json === 'object' && 'configuration' in json && 'updated_at' in json;
}
exports.isRawSBUConfigPayload = isRawSBUConfigPayload;
